# æ¶²ä½“æ³„æ¼æ³¼æº…æ£€æµ‹æ£€æµ‹ç³»ç»Ÿæºç åˆ†äº«
 # [ä¸€æ¡é¾™æ•™å­¦YOLOV8æ ‡æ³¨å¥½çš„æ•°æ®é›†ä¸€é”®è®­ç»ƒ_70+å…¨å¥—æ”¹è¿›åˆ›æ–°ç‚¹å‘åˆŠ_Webå‰ç«¯å±•ç¤º]

### 1.ç ”ç©¶èƒŒæ™¯ä¸Žæ„ä¹‰

é¡¹ç›®å‚è€ƒ[AAAI Association for the Advancement of Artificial Intelligence](https://gitee.com/qunmasj/projects)

é¡¹ç›®æ¥æº[AACV Association for the Advancement of Computer Vision](https://kdocs.cn/l/cszuIiCKVNis)

ç ”ç©¶èƒŒæ™¯ä¸Žæ„ä¹‰

éšç€å·¥ä¸šåŒ–è¿›ç¨‹çš„åŠ å¿«ï¼Œæ¶²ä½“æ³„æ¼é—®é¢˜æ—¥ç›Šä¸¥é‡ï¼Œå°¤å…¶æ˜¯åœ¨åŒ–å·¥ã€çŸ³æ²¹å’Œé£Ÿå“ç­‰è¡Œä¸šï¼Œæ¶²ä½“æ³„æ¼ä¸ä»…ä¼šé€ æˆç»æµŽæŸå¤±ï¼Œè¿˜å¯èƒ½å¯¹çŽ¯å¢ƒå’Œäººç±»å¥åº·é€ æˆä¸¥é‡å¨èƒã€‚å› æ­¤ï¼ŒåŠæ—¶ã€å‡†ç¡®åœ°æ£€æµ‹æ¶²ä½“æ³„æ¼åŠå…¶æ³¼æº…çŽ°è±¡ï¼Œæˆä¸ºäº†ä¿éšœç”Ÿäº§å®‰å…¨å’ŒçŽ¯å¢ƒä¿æŠ¤çš„é‡è¦ä»»åŠ¡ã€‚ä¼ ç»Ÿçš„æ¶²ä½“æ³„æ¼æ£€æµ‹æ–¹æ³•å¤šä¾èµ–äººå·¥ç›‘æµ‹å’Œç®€å•çš„ä¼ æ„Ÿå™¨ï¼Œè¿™äº›æ–¹æ³•ä¸ä»…æ•ˆçŽ‡ä½Žä¸‹ï¼Œè€Œä¸”å®¹æ˜“å—åˆ°äººä¸ºå› ç´ çš„å½±å“ï¼Œå¯¼è‡´æ¼æ£€æˆ–è¯¯æ£€çš„æƒ…å†µå‘ç”Ÿã€‚ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼ŒåŸºäºŽè®¡ç®—æœºè§†è§‰çš„è‡ªåŠ¨åŒ–æ£€æµ‹ç³»ç»Ÿé€æ¸æˆä¸ºç ”ç©¶çš„çƒ­ç‚¹ã€‚

è¿‘å¹´æ¥ï¼Œæ·±åº¦å­¦ä¹ æŠ€æœ¯çš„å¿«é€Ÿå‘å±•ä¸ºç›®æ ‡æ£€æµ‹é¢†åŸŸå¸¦æ¥äº†é©å‘½æ€§çš„å˜åŒ–ã€‚YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—æ¨¡åž‹å› å…¶é«˜æ•ˆçš„å®žæ—¶æ£€æµ‹èƒ½åŠ›å’Œè¾ƒé«˜çš„å‡†ç¡®çŽ‡ï¼Œå¹¿æ³›åº”ç”¨äºŽå„ç§ç‰©ä½“æ£€æµ‹ä»»åŠ¡ä¸­ã€‚YOLOv8ä½œä¸ºè¯¥ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¿›ä¸€æ­¥æå‡äº†æ¨¡åž‹çš„æ€§èƒ½å’Œé€‚ç”¨æ€§ã€‚ç„¶è€Œï¼Œé’ˆå¯¹æ¶²ä½“æ³„æ¼æ³¼æº…çš„ç‰¹å®šåœºæ™¯ï¼ŒYOLOv8ä»ç„¶é¢ä¸´ç€ä¸€äº›æŒ‘æˆ˜ï¼Œå¦‚èƒŒæ™¯å¤æ‚æ€§ã€æ¶²ä½“å½¢æ€å¤šæ ·æ€§ä»¥åŠå…‰ç…§å˜åŒ–ç­‰ã€‚å› æ­¤ï¼Œæ”¹è¿›YOLOv8æ¨¡åž‹ä»¥é€‚åº”æ¶²ä½“æ³„æ¼æ£€æµ‹çš„éœ€æ±‚ï¼Œå…·æœ‰é‡è¦çš„ç ”ç©¶æ„ä¹‰ã€‚

æœ¬ç ”ç©¶åŸºäºŽæ”¹è¿›YOLOv8æ¨¡åž‹ï¼Œæž„å»ºäº†ä¸€å¥—æ¶²ä½“æ³„æ¼æ³¼æº…æ£€æµ‹ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿçš„æ ¸å¿ƒåœ¨äºŽåˆ©ç”¨3200å¼ æ ‡æ³¨å›¾åƒçš„æ•°æ®é›†ï¼Œä¸“æ³¨äºŽæ¶²ä½“æ³¼æº…è¿™ä¸€ç‰¹å®šç±»åˆ«ã€‚é€šè¿‡å¯¹æ•°æ®é›†çš„æ·±å…¥åˆ†æžå’Œå¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥æå–å‡ºæ¶²ä½“æ³„æ¼çš„ç‰¹å¾ä¿¡æ¯ï¼Œå¹¶é€šè¿‡æ¨¡åž‹è®­ç»ƒæé«˜æ£€æµ‹çš„å‡†ç¡®æ€§å’Œé²æ£’æ€§ã€‚æ­¤å¤–ï¼Œæ”¹è¿›çš„YOLOv8æ¨¡åž‹èƒ½å¤Ÿåœ¨ä¿æŒé«˜æ•ˆæ£€æµ‹é€Ÿåº¦çš„åŒæ—¶ï¼Œå¢žå¼ºå¯¹æ¶²ä½“æ³„æ¼ç‰¹å¾çš„è¯†åˆ«èƒ½åŠ›ï¼Œä»Žè€Œå®žçŽ°å®žæ—¶ç›‘æµ‹å’Œé¢„è­¦ã€‚

æœ¬ç ”ç©¶çš„æ„ä¹‰ä¸ä»…åœ¨äºŽæŠ€æœ¯å±‚é¢çš„åˆ›æ–°ï¼Œæ›´åœ¨äºŽå…¶å¯¹å®žé™…åº”ç”¨çš„æŽ¨åŠ¨ã€‚é€šè¿‡æž„å»ºé«˜æ•ˆçš„æ¶²ä½“æ³„æ¼æ£€æµ‹ç³»ç»Ÿï¼Œå¯ä»¥æ˜¾è‘—é™ä½Žäººå·¥ç›‘æµ‹çš„æˆæœ¬ï¼Œæé«˜æ¶²ä½“æ³„æ¼äº‹ä»¶çš„å“åº”é€Ÿåº¦ï¼Œè¿›è€Œå‡å°‘æ½œåœ¨çš„ç»æµŽæŸå¤±å’ŒçŽ¯å¢ƒæ±¡æŸ“ã€‚åŒæ—¶ï¼Œè¯¥ç³»ç»Ÿçš„æˆåŠŸåº”ç”¨è¿˜å¯ä»¥ä¸ºå…¶ä»–é¢†åŸŸçš„ç›®æ ‡æ£€æµ‹æä¾›å€Ÿé‰´ï¼ŒæŽ¨åŠ¨æ·±åº¦å­¦ä¹ æŠ€æœ¯åœ¨å·¥ä¸šå®‰å…¨ã€çŽ¯å¢ƒç›‘æµ‹ç­‰æ–¹é¢çš„å¹¿æ³›åº”ç”¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒåŸºäºŽæ”¹è¿›YOLOv8çš„æ¶²ä½“æ³„æ¼æ³¼æº…æ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶ï¼Œä¸ä»…å¡«è¡¥äº†çŽ°æœ‰æŠ€æœ¯åœ¨æ¶²ä½“æ³„æ¼æ£€æµ‹é¢†åŸŸçš„ç©ºç™½ï¼Œä¹Ÿä¸ºç›¸å…³è¡Œä¸šæä¾›äº†åˆ‡å®žå¯è¡Œçš„è§£å†³æ–¹æ¡ˆï¼Œå…·æœ‰é‡è¦çš„ç†è®ºä»·å€¼å’Œå®žé™…æ„ä¹‰ã€‚é€šè¿‡ä¸æ–­ä¼˜åŒ–å’Œå®Œå–„è¯¥ç³»ç»Ÿï¼Œæœªæ¥æœ‰æœ›åœ¨æ›´å¹¿æ³›çš„åœºæ™¯ä¸­å®žçŽ°é«˜æ•ˆã€å‡†ç¡®çš„æ¶²ä½“æ³„æ¼ç›‘æµ‹ï¼Œä¸ºå®‰å…¨ç”Ÿäº§å’ŒçŽ¯å¢ƒä¿æŠ¤è´¡çŒ®åŠ›é‡ã€‚

### 2.å›¾ç‰‡æ¼”ç¤º

![1.png](1.png)

![2.png](2.png)

![3.png](3.png)

##### æ³¨æ„ï¼šç”±äºŽæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ2.å›¾ç‰‡æ¼”ç¤ºâ€å’Œâ€œ3.è§†é¢‘æ¼”ç¤ºâ€å±•ç¤ºçš„ç³»ç»Ÿå›¾ç‰‡æˆ–è€…è§†é¢‘å¯èƒ½ä¸ºè€ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬åœ¨è€ç‰ˆæœ¬çš„åŸºç¡€ä¸Šå‡çº§å¦‚ä¸‹ï¼šï¼ˆå®žé™…æ•ˆæžœä»¥å‡çº§çš„æ–°ç‰ˆæœ¬ä¸ºå‡†ï¼‰

  ï¼ˆ1ï¼‰é€‚é…äº†YOLOV8çš„â€œç›®æ ‡æ£€æµ‹â€æ¨¡åž‹å’Œâ€œå®žä¾‹åˆ†å‰²â€æ¨¡åž‹ï¼Œé€šè¿‡åŠ è½½ç›¸åº”çš„æƒé‡ï¼ˆ.ptï¼‰æ–‡ä»¶å³å¯è‡ªé€‚åº”åŠ è½½æ¨¡åž‹ã€‚

  ï¼ˆ2ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®žæ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«æ¨¡å¼ã€‚

  ï¼ˆ3ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®žæ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«ç»“æžœä¿å­˜å¯¼å‡ºï¼Œè§£å†³æ‰‹åŠ¨å¯¼å‡ºï¼ˆå®¹æ˜“å¡é¡¿å‡ºçŽ°çˆ†å†…å­˜ï¼‰å­˜åœ¨çš„é—®é¢˜ï¼Œè¯†åˆ«å®Œè‡ªåŠ¨ä¿å­˜ç»“æžœå¹¶å¯¼å‡ºåˆ°tempDirä¸­ã€‚

  ï¼ˆ4ï¼‰æ”¯æŒWebå‰ç«¯ç³»ç»Ÿä¸­çš„æ ‡é¢˜ã€èƒŒæ™¯å›¾ç­‰è‡ªå®šä¹‰ä¿®æ”¹ï¼ŒåŽé¢æä¾›ä¿®æ”¹æ•™ç¨‹ã€‚

  å¦å¤–æœ¬é¡¹ç›®æä¾›è®­ç»ƒçš„æ•°æ®é›†å’Œè®­ç»ƒæ•™ç¨‹,æš‚ä¸æä¾›æƒé‡æ–‡ä»¶ï¼ˆbest.ptï¼‰,éœ€è¦æ‚¨æŒ‰ç…§æ•™ç¨‹è¿›è¡Œè®­ç»ƒåŽå®žçŽ°å›¾ç‰‡æ¼”ç¤ºå’ŒWebå‰ç«¯ç•Œé¢æ¼”ç¤ºçš„æ•ˆæžœã€‚

### 3.è§†é¢‘æ¼”ç¤º

[3.1 è§†é¢‘æ¼”ç¤º](https://www.bilibili.com/video/BV1oHszetEVy/)

### 4.æ•°æ®é›†ä¿¡æ¯å±•ç¤º

##### 4.1 æœ¬é¡¹ç›®æ•°æ®é›†è¯¦ç»†æ•°æ®ï¼ˆç±»åˆ«æ•°ï¼†ç±»åˆ«åï¼‰

nc: 1
names: ['Spill']


##### 4.2 æœ¬é¡¹ç›®æ•°æ®é›†ä¿¡æ¯ä»‹ç»

æ•°æ®é›†ä¿¡æ¯å±•ç¤º

åœ¨çŽ°ä»£å·¥ä¸šå’ŒçŽ¯å¢ƒç›‘æµ‹é¢†åŸŸï¼Œæ¶²ä½“æ³„æ¼æ³¼æº…çš„åŠæ—¶æ£€æµ‹è‡³å…³é‡è¦ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æž„å»ºäº†ä¸€ä¸ªä¸“é—¨ç”¨äºŽè®­ç»ƒæ”¹è¿›YOLOv8çš„æ¶²ä½“æ³„æ¼æ³¼æº…æ£€æµ‹ç³»ç»Ÿçš„æ•°æ®é›†ï¼Œå‘½åä¸ºâ€œSpill Detectionâ€ã€‚è¯¥æ•°æ®é›†æ—¨åœ¨ä¸ºç ”ç©¶äººå‘˜å’Œå¼€å‘è€…æä¾›ä¸€ä¸ªé«˜è´¨é‡çš„è®­ç»ƒåŸºç¡€ï¼Œä»¥æå‡æ¶²ä½“æ³„æ¼æ£€æµ‹çš„å‡†ç¡®æ€§å’Œæ•ˆçŽ‡ã€‚

â€œSpill Detectionâ€æ•°æ®é›†åŒ…å«äº†ä¸°å¯Œçš„æ¶²ä½“æ³„æ¼åœºæ™¯ï¼Œä¸“æ³¨äºŽä¸€ç§ä¸»è¦ç±»åˆ«ï¼šæ¶²ä½“æ³¼æº…ã€‚è¯¥æ•°æ®é›†çš„ç±»åˆ«æ•°é‡ä¸º1ï¼Œå…·ä½“ç±»åˆ«åˆ—è¡¨ä¸ºâ€œSpillâ€ã€‚è¿™ä¸€è®¾è®¡ä½¿å¾—æ•°æ®é›†åœ¨å¤„ç†æ¶²ä½“æ³„æ¼æ£€æµ‹æ—¶æ›´åŠ ä¸“æ³¨ï¼Œä¾¿äºŽæ¨¡åž‹çš„è®­ç»ƒå’Œä¼˜åŒ–ã€‚é€šè¿‡èšç„¦äºŽè¿™ä¸€å•ä¸€ç±»åˆ«ï¼Œæˆ‘ä»¬èƒ½å¤Ÿç¡®ä¿æ¨¡åž‹åœ¨è¯†åˆ«å’Œå®šä½æ¶²ä½“æ³„æ¼æ–¹é¢çš„é«˜æ•ˆæ€§å’Œå‡†ç¡®æ€§ã€‚

æ•°æ®é›†ä¸­çš„å›¾åƒæ¶µç›–äº†å¤šç§æ¶²ä½“æ³„æ¼çš„æƒ…å¢ƒï¼ŒåŒ…æ‹¬ä½†ä¸é™äºŽå·¥ä¸šè®¾å¤‡å‘¨å›´çš„æ²¹æ¸ã€åŒ–å­¦å“æ³„æ¼ã€ä»¥åŠæ—¥å¸¸ç”Ÿæ´»ä¸­å¯èƒ½å‡ºçŽ°çš„æ°´æ´’ç­‰æƒ…å†µã€‚è¿™äº›å›¾åƒä¸ä»…å±•ç¤ºäº†ä¸åŒç±»åž‹çš„æ¶²ä½“ï¼Œè¿˜è€ƒè™‘äº†ä¸åŒçš„çŽ¯å¢ƒèƒŒæ™¯å’Œå…‰ç…§æ¡ä»¶ï¼Œä»¥å¢žå¼ºæ¨¡åž‹çš„æ³›åŒ–èƒ½åŠ›ã€‚é€šè¿‡å¤šæ ·åŒ–çš„åœºæ™¯è®¾ç½®ï¼Œæ•°æ®é›†èƒ½å¤Ÿå¸®åŠ©æ¨¡åž‹å­¦ä¹ åˆ°æ¶²ä½“æ³„æ¼çš„å¤šç§ç‰¹å¾ï¼Œä»Žè€Œåœ¨å®žé™…åº”ç”¨ä¸­è¡¨çŽ°å‡ºæ›´å¼ºçš„é€‚åº”æ€§ã€‚

åœ¨æ•°æ®é›†çš„æž„å»ºè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ä¸¥æ ¼çš„æ ‡æ³¨æ ‡å‡†ï¼Œç¡®ä¿æ¯ä¸€å¼ å›¾åƒä¸­çš„æ¶²ä½“æ³¼æº…åŒºåŸŸéƒ½å¾—åˆ°äº†å‡†ç¡®çš„æ ‡è®°ã€‚è¿™ä¸€è¿‡ç¨‹ä¸ä»…åŒ…æ‹¬äººå·¥æ ‡æ³¨ï¼Œè¿˜ç»“åˆäº†è‡ªåŠ¨åŒ–å·¥å…·çš„è¾…åŠ©ï¼Œä»¥æé«˜æ ‡æ³¨çš„æ•ˆçŽ‡å’Œå‡†ç¡®æ€§ã€‚æ¯ä¸ªæ ‡æ³¨çš„æ¶²ä½“æ³¼æº…åŒºåŸŸéƒ½ç»è¿‡ä»”ç»†å®¡æ ¸ï¼Œç¡®ä¿æ•°æ®é›†çš„é«˜è´¨é‡ã€‚è¿™ç§é«˜è´¨é‡çš„æ ‡æ³¨å¯¹äºŽè®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡åž‹è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒç›´æŽ¥å½±å“åˆ°æ¨¡åž‹çš„å­¦ä¹ æ•ˆæžœå’Œæœ€ç»ˆçš„æ£€æµ‹æ€§èƒ½ã€‚

æ­¤å¤–ï¼Œä¸ºäº†è¿›ä¸€æ­¥æå‡æ¨¡åž‹çš„è®­ç»ƒæ•ˆæžœï¼Œæˆ‘ä»¬åœ¨æ•°æ®é›†ä¸­å¼•å…¥äº†æ•°æ®å¢žå¼ºæŠ€æœ¯ã€‚è¿™äº›æŠ€æœ¯åŒ…æ‹¬éšæœºè£å‰ªã€æ—‹è½¬ã€äº®åº¦è°ƒæ•´ç­‰ï¼Œæ—¨åœ¨å¢žåŠ æ•°æ®çš„å¤šæ ·æ€§å’Œä¸°å¯Œæ€§ã€‚é€šè¿‡è¿™äº›å¢žå¼ºæ–¹æ³•ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæœ‰æ•ˆåœ°æ‰©å±•æ•°æ®é›†çš„è§„æ¨¡ï¼Œä½¿å¾—æ¨¡åž‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­èƒ½å¤ŸæŽ¥è§¦åˆ°æ›´å¤šçš„æ ·æœ¬å˜ä½“ï¼Œä»Žè€Œæé«˜å…¶é²æ£’æ€§å’Œæ³›åŒ–èƒ½åŠ›ã€‚

â€œSpill Detectionâ€æ•°æ®é›†ä¸ä»…é€‚ç”¨äºŽYOLOv8çš„è®­ç»ƒï¼Œä¹Ÿä¸ºå…¶ä»–æ¶²ä½“æ³„æ¼æ£€æµ‹ç®—æ³•çš„ç ”ç©¶æä¾›äº†åŸºç¡€ã€‚éšç€æ¶²ä½“æ³„æ¼æ£€æµ‹æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œè¯¥æ•°æ®é›†çš„åº”ç”¨å‰æ™¯å¹¿é˜”ã€‚ç ”ç©¶äººå‘˜å¯ä»¥åˆ©ç”¨è¿™ä¸€æ•°æ®é›†è¿›è¡Œç®—æ³•çš„å¯¹æ¯”ç ”ç©¶ã€æ€§èƒ½è¯„ä¼°ä»¥åŠæ–°æŠ€æœ¯çš„å¼€å‘ï¼Œä»Žè€ŒæŽ¨åŠ¨æ¶²ä½“æ³„æ¼æ£€æµ‹é¢†åŸŸçš„è¿›æ­¥ã€‚

æ€»ä¹‹ï¼Œâ€œSpill Detectionâ€æ•°æ®é›†ä¸ºæ¶²ä½“æ³„æ¼æ³¼æº…æ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶ä¸Žå¼€å‘æä¾›äº†ä¸€ä¸ªåšå®žçš„åŸºç¡€ã€‚é€šè¿‡é«˜è´¨é‡çš„æ ‡æ³¨ã€å¤šæ ·åŒ–çš„åœºæ™¯å’Œæ•°æ®å¢žå¼ºæŠ€æœ¯ï¼Œè¯¥æ•°æ®é›†å°†ä¸ºæ”¹è¿›YOLOv8æ¨¡åž‹çš„è®­ç»ƒæä¾›é‡è¦æ”¯æŒï¼ŒåŠ©åŠ›äºŽå®žçŽ°æ›´é«˜æ•ˆã€æ›´å‡†ç¡®çš„æ¶²ä½“æ³„æ¼æ£€æµ‹ã€‚

![4.png](4.png)

![5.png](5.png)

![6.png](6.png)

![7.png](7.png)

![8.png](8.png)

### 5.å…¨å¥—é¡¹ç›®çŽ¯å¢ƒéƒ¨ç½²è§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[5.1 çŽ¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æŽ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404473917358506534?logTag=c807d0cbc21c0ef59de5)




[5.2 å®‰è£…Pythonè™šæ‹ŸçŽ¯å¢ƒåˆ›å»ºå’Œä¾èµ–åº“å®‰è£…è§†é¢‘æ•™ç¨‹é“¾æŽ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404474678003106304?logTag=1f1041108cd1f708b01a)

### 6.æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰

[6.1 æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰](https://www.ixigua.com/7404477157818401292?logTag=d31a2dfd1983c9668658)

### 7.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡åž‹çš„é…ç½®æ–‡ä»¶ï¼‰

[7.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡åž‹çš„é…ç½®æ–‡ä»¶ï¼‰](https://www.ixigua.com/7404478314661806627?logTag=29066f8288e3f4eea3a4)

### 8.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŽŸç†è®²è§£ï¼ˆéžç§‘ç­ä¹Ÿå¯ä»¥è½»æ¾å†™åˆŠå‘åˆŠï¼ŒV10ç‰ˆæœ¬æ­£åœ¨ç§‘ç ”å¾…æ›´æ–°ï¼‰

ç”±äºŽç¯‡å¹…é™åˆ¶ï¼Œæ¯ä¸ªåˆ›æ–°ç‚¹çš„å…·ä½“åŽŸç†è®²è§£å°±ä¸ä¸€ä¸€å±•å¼€ï¼Œå…·ä½“è§ä¸‹åˆ—ç½‘å€ä¸­çš„åˆ›æ–°ç‚¹å¯¹åº”å­é¡¹ç›®çš„æŠ€æœ¯åŽŸç†åšå®¢ç½‘å€ã€Blogã€‘ï¼š

![9.png](9.png)

[8.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŽŸç†è®²è§£é“¾æŽ¥](https://gitee.com/qunmasj/good)

### 9.ç³»ç»ŸåŠŸèƒ½å±•ç¤ºï¼ˆæ£€æµ‹å¯¹è±¡ä¸ºä¸¾ä¾‹ï¼Œå®žé™…å†…å®¹ä»¥æœ¬é¡¹ç›®æ•°æ®é›†ä¸ºå‡†ï¼‰

å›¾9.1.ç³»ç»Ÿæ”¯æŒæ£€æµ‹ç»“æžœè¡¨æ ¼æ˜¾ç¤º

  å›¾9.2.ç³»ç»Ÿæ”¯æŒç½®ä¿¡åº¦å’ŒIOUé˜ˆå€¼æ‰‹åŠ¨è°ƒèŠ‚

  å›¾9.3.ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰åŠ è½½æƒé‡æ–‡ä»¶best.pt(éœ€è¦ä½ é€šè¿‡æ­¥éª¤5ä¸­è®­ç»ƒèŽ·å¾—)

  å›¾9.4.ç³»ç»Ÿæ”¯æŒæ‘„åƒå¤´å®žæ—¶è¯†åˆ«

  å›¾9.5.ç³»ç»Ÿæ”¯æŒå›¾ç‰‡è¯†åˆ«

  å›¾9.6.ç³»ç»Ÿæ”¯æŒè§†é¢‘è¯†åˆ«

  å›¾9.7.ç³»ç»Ÿæ”¯æŒè¯†åˆ«ç»“æžœæ–‡ä»¶è‡ªåŠ¨ä¿å­˜

  å›¾9.8.ç³»ç»Ÿæ”¯æŒExcelå¯¼å‡ºæ£€æµ‹ç»“æžœæ•°æ®

![10.png](10.png)

![11.png](11.png)

![12.png](12.png)

![13.png](13.png)

![14.png](14.png)

![15.png](15.png)

![16.png](16.png)

![17.png](17.png)

### 10.åŽŸå§‹YOLOV8ç®—æ³•åŽŸç†

åŽŸå§‹YOLOv8ç®—æ³•åŽŸç†

YOLOv8ä½œä¸ºYOLOç³»åˆ—ä¸­çš„æœ€æ–°ç‰ˆæœ¬ï¼Œæ ‡å¿—ç€ç›®æ ‡æ£€æµ‹é¢†åŸŸçš„ä¸€æ¬¡é‡è¦è¿›æ­¥ã€‚ä¸Žå‰ä»£æ¨¡åž‹ç›¸æ¯”ï¼ŒYOLOv8åœ¨æ£€æµ‹ç²¾åº¦å’Œé€Ÿåº¦ä¸Šå‡æœ‰æ˜¾è‘—æå‡ï¼Œè¿™ä½¿å¾—å®ƒåœ¨å®žé™…åº”ç”¨ä¸­å…·å¤‡äº†æ›´å¼ºçš„ç«žäº‰åŠ›ã€‚YOLOv8çš„è®¾è®¡ç†å¿µæ˜¯é€šè¿‡ä¼˜åŒ–ç½‘ç»œç»“æž„å’Œç®—æ³•æµç¨‹ï¼Œè¾¾åˆ°æ›´é«˜çš„æ€§èƒ½ï¼ŒåŒæ—¶ä¿æŒæ¨¡åž‹çš„è½»é‡åŒ–å’Œå®žæ—¶æ€§ã€‚è¯¥æ¨¡åž‹æ ¹æ®ä¸åŒçš„åº”ç”¨åœºæ™¯è¢«ç»†åˆ†ä¸ºäº”ç§ä¸åŒçš„ç‰ˆæœ¬ï¼ŒåŒ…æ‹¬YOLOv8nã€sã€mã€lå’Œxï¼Œå…¶ä¸­YOLOv8nä»¥å…¶æœ€å°çš„å‚æ•°é‡å’Œæœ€å¿«çš„æ£€æµ‹é€Ÿåº¦ï¼Œæˆä¸ºäº†è®¸å¤šå®žæ—¶åº”ç”¨çš„é¦–é€‰ã€‚

YOLOv8çš„ç½‘ç»œç»“æž„å¯ä»¥åˆ†ä¸ºå››ä¸ªä¸»è¦éƒ¨åˆ†ï¼šè¾“å…¥ç«¯ã€éª¨å¹²ç½‘ç»œã€é¢ˆéƒ¨ç½‘ç»œå’Œå¤´éƒ¨ç½‘ç»œã€‚è¾“å…¥ç«¯çš„è®¾è®¡é‡‡ç”¨äº†é©¬èµ›å…‹æ•°æ®å¢žå¼ºã€è‡ªé€‚åº”é”šæ¡†è®¡ç®—å’Œè‡ªé€‚åº”ç°åº¦å¡«å……ç­‰æŠ€æœ¯ï¼Œè¿™äº›æ–¹æ³•ä¸ä»…æå‡äº†æ¨¡åž‹çš„é²æ£’æ€§å’Œæ³›åŒ–èƒ½åŠ›ï¼Œè¿˜åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¼˜åŒ–äº†æ•°æ®çš„çœŸå®žåˆ†å¸ƒã€‚å°¤å…¶æ˜¯é©¬èµ›å…‹æ•°æ®å¢žå¼ºï¼Œé€šè¿‡å°†å¤šå¼ å›¾åƒæ‹¼æŽ¥æˆä¸€å¼ æ–°çš„å›¾åƒï¼Œå¢žåŠ äº†è®­ç»ƒæ ·æœ¬çš„å¤šæ ·æ€§ï¼Œä»Žè€Œæé«˜äº†æ¨¡åž‹å¯¹ä¸åŒåœºæ™¯çš„é€‚åº”èƒ½åŠ›ã€‚

åœ¨éª¨å¹²ç½‘ç»œéƒ¨åˆ†ï¼ŒYOLOv8å¼•å…¥äº†C2fæ¨¡å—å’Œç©ºé—´é‡‘å­—å¡”æ± åŒ–èžåˆï¼ˆSPPFï¼‰ç»“æž„ã€‚C2fæ¨¡å—æ˜¯YOLOv8çš„æ ¸å¿ƒç‰¹å¾æå–å•å…ƒï¼Œå®ƒé€šè¿‡è·¨å±‚è¿žæŽ¥å’Œåˆ†æ”¯ç»“æž„ï¼Œå¢žå¼ºäº†æ¨¡åž‹çš„æ¢¯åº¦æµåŠ¨æ€§ï¼Œæå‡äº†ç‰¹å¾è¡¨ç¤ºèƒ½åŠ›ã€‚è¿™ç§è®¾è®¡çµæ„Ÿæ¥æºäºŽYOLOv7çš„ELANç»“æž„ï¼Œè¿›ä¸€æ­¥ä¸°å¯Œäº†ç‰¹å¾å­¦ä¹ çš„å¤šæ ·æ€§ï¼Œä½¿å¾—æ¨¡åž‹åœ¨å¤„ç†å¤æ‚åœºæ™¯æ—¶èƒ½å¤Ÿæå–åˆ°æ›´ä¸ºç»†è‡´çš„ç‰¹å¾ä¿¡æ¯ã€‚åŒæ—¶ï¼ŒSPPFæ¨¡å—çš„ä¿ç•™ä¸ä»…ä¿è¯äº†ç‰¹å¾æå–çš„æ•ˆæžœï¼Œè¿˜åœ¨æ‰§è¡Œæ—¶é—´ä¸Šå¾—åˆ°äº†ä¼˜åŒ–ï¼Œæå‡äº†æ•´ä½“çš„è®¡ç®—æ•ˆçŽ‡ã€‚

é¢ˆéƒ¨ç½‘ç»œé‡‡ç”¨äº†è·¯å¾„èšåˆç½‘ç»œï¼ˆPANï¼‰ç»“æž„ï¼Œè¿™ä¸€è®¾è®¡ä½¿å¾—YOLOv8åœ¨å¤„ç†ä¸åŒå°ºåº¦çš„ç›®æ ‡æ—¶ï¼Œèƒ½å¤Ÿæ›´å¥½åœ°èžåˆç‰¹å¾ä¿¡æ¯ã€‚PANç»“æž„é€šè¿‡å¢žå¼ºä¸åŒå±‚æ¬¡ç‰¹å¾çš„è¿žæŽ¥ï¼Œæå‡äº†æ¨¡åž‹å¯¹å°ç›®æ ‡å’Œå¤§ç›®æ ‡çš„æ£€æµ‹èƒ½åŠ›ï¼Œç¡®ä¿äº†åœ¨å¤šå°ºåº¦åœºæ™¯ä¸‹çš„æ£€æµ‹ç²¾åº¦ã€‚

å¤´éƒ¨ç½‘ç»œçš„è®¾è®¡æ˜¯YOLOv8çš„ä¸€å¤§äº®ç‚¹ï¼Œå®ƒå°†åˆ†ç±»å’Œæ£€æµ‹è¿‡ç¨‹è¿›è¡Œäº†æœ‰æ•ˆçš„è§£è€¦ã€‚é€šè¿‡å¼•å…¥è§£è€¦å¤´ç»“æž„ï¼ŒYOLOv8åœ¨åˆ†ç±»å’Œå®šä½ä»»åŠ¡ä¸Šåˆ†åˆ«ä½¿ç”¨ä¸¤æ¡å¹¶è¡Œçš„åˆ†æ”¯ï¼Œè¿™æ ·çš„è®¾è®¡ä½¿å¾—æ¨¡åž‹èƒ½å¤Ÿæ›´å¥½åœ°é’ˆå¯¹ä¸åŒä»»åŠ¡è¿›è¡Œä¼˜åŒ–ã€‚åˆ†ç±»ä»»åŠ¡æ›´å…³æ³¨ç‰¹å¾å›¾ä¸­ç±»åˆ«çš„ç›¸ä¼¼æ€§ï¼Œè€Œå®šä½ä»»åŠ¡åˆ™æ³¨é‡è¾¹ç•Œæ¡†ä¸ŽçœŸå®žæ¡†çš„å…³ç³»ï¼Œè¿™ç§åˆ†ç¦»çš„ç­–ç•¥æ˜¾è‘—æé«˜äº†æ¨¡åž‹çš„æ”¶æ•›é€Ÿåº¦å’Œé¢„æµ‹ç²¾åº¦ã€‚æ­¤å¤–ï¼ŒYOLOv8è¿˜é‡‡ç”¨äº†æ— é”šæ¡†æ£€æµ‹å¤´ï¼Œç›´æŽ¥é¢„æµ‹ç›®æ ‡çš„ä¸­å¿ƒä½ç½®ï¼Œå‡å°‘äº†é”šæ¡†çš„é¢„æµ‹æ•°é‡ï¼Œä»Žè€ŒåŠ é€Ÿäº†éžæœ€å¤§æŠ‘åˆ¶ï¼ˆNMSï¼‰è¿‡ç¨‹ï¼Œè¿›ä¸€æ­¥æå‡äº†æ£€æµ‹æ•ˆçŽ‡ã€‚

åœ¨æŸå¤±è®¡ç®—æ–¹é¢ï¼ŒYOLOv8å¼•å…¥äº†æ–°çš„æŸå¤±ç­–ç•¥ï¼ŒåŒ…æ‹¬ä»»åŠ¡å¯¹é½å­¦ä¹ ï¼ˆTask Alignment Learningï¼‰å’Œåˆ†å¸ƒç„¦ç‚¹æŸå¤±ï¼ˆDistribution Focal Lossï¼‰ï¼Œä»¥æ­¤æ¥ä¼˜åŒ–åˆ†ç±»å’Œå›žå½’çš„æŸå¤±è®¡ç®—ã€‚ä»»åŠ¡å¯¹é½å­¦ä¹ é€šè¿‡ç»“åˆåˆ†ç±»åˆ†æ•°å’Œäº¤å¹¶æ¯”ï¼ˆIoUï¼‰çš„é«˜æ¬¡å¹‚ä¹˜ç§¯ï¼Œæå‡äº†æ¨¡åž‹åœ¨åˆ†ç±»å’Œå®šä½ä»»åŠ¡ä¸Šçš„è¡¨çŽ°ã€‚åˆ†ç±»åˆ†æ”¯é‡‡ç”¨äº†äºŒå…ƒäº¤å‰ç†µæŸå¤±ï¼ˆBinary Cross Entropy Lossï¼‰ï¼Œè€Œå›žå½’åˆ†æ”¯åˆ™ç»“åˆäº†å®Œç¾Žäº¤å¹¶æ¯”æŸå¤±ï¼ˆComplete Intersection over Union Lossï¼‰ï¼Œè¿™ä¸¤è€…çš„ç»“åˆä½¿å¾—YOLOv8åœ¨è¾¹ç•Œæ¡†é¢„æµ‹ä¸Šå…·å¤‡äº†æ›´é«˜çš„å‡†ç¡®æ€§ã€‚

YOLOv8åœ¨å®žé™…åº”ç”¨ä¸­çš„è¡¨çŽ°ä¹Ÿç›¸å½“å‡ºè‰²ã€‚åœ¨COCOæ•°æ®é›†ä¸Šçš„å®žéªŒç»“æžœæ˜¾ç¤ºï¼ŒYOLOv8åœ¨åŒç­‰æ¨¡åž‹å°ºå¯¸ä¸‹ï¼Œèƒ½å¤Ÿåœ¨ä¸æ˜¾è‘—å¢žåŠ å‚æ•°é‡çš„å‰æä¸‹ï¼Œå–å¾—æ›´å¥½çš„æ£€æµ‹ç²¾åº¦å’ŒæŽ¨ç†é€Ÿåº¦ã€‚è¿™ä¸€ç‰¹æ€§ä½¿å¾—YOLOv8æˆä¸ºäº†å®žæ—¶ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸­çš„ä¸€ä¸ªç†æƒ³é€‰æ‹©ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦å¿«é€Ÿå“åº”çš„åœºæ™¯ä¸­ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒYOLOv8ç®—æ³•é€šè¿‡ä¸€ç³»åˆ—åˆ›æ–°çš„è®¾è®¡å’Œä¼˜åŒ–ï¼Œä¸ä»…æå‡äº†ç›®æ ‡æ£€æµ‹çš„ç²¾åº¦å’Œé€Ÿåº¦ï¼Œè¿˜åœ¨æ¨¡åž‹çš„è½»é‡åŒ–å’Œå®žæ—¶æ€§æ–¹é¢åšå‡ºäº†æ˜¾è‘—è´¡çŒ®ã€‚å…¶åœ¨éª¨å¹²ç½‘ç»œã€é¢ˆéƒ¨ç½‘ç»œå’Œå¤´éƒ¨ç½‘ç»œçš„æ”¹è¿›ï¼Œä½¿å¾—YOLOv8åœ¨å¤„ç†å¤æ‚åœºæ™¯æ—¶è¡¨çŽ°å‡ºè‰²ï¼Œå…·å¤‡äº†å¹¿æ³›çš„åº”ç”¨å‰æ™¯ã€‚éšç€YOLOv8çš„æŽ¨å‡ºï¼Œç›®æ ‡æ£€æµ‹æŠ€æœ¯çš„ç ”ç©¶å’Œåº”ç”¨å°†è¿›å…¥ä¸€ä¸ªæ–°çš„é˜¶æ®µï¼Œä¸ºå„ç±»æ™ºèƒ½åº”ç”¨æä¾›äº†æ›´ä¸ºå¼ºå¤§çš„æŠ€æœ¯æ”¯æŒã€‚

![18.png](18.png)

### 11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰

#### 11.1 code\ultralytics\solutions\ai_gym.py

ä»¥ä¸‹æ˜¯å¯¹ç»™å®šä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†è¿›è¡Œæç‚¼å’Œè¯¦ç»†æ³¨é‡Šçš„ç»“æžœï¼š

```python
# å¯¼å…¥å¿…è¦çš„åº“
import cv2
from ultralytics.utils.checks import check_imshow
from ultralytics.utils.plotting import Annotator

class AIGym:
    """ç”¨äºŽç®¡ç†åŸºäºŽå§¿åŠ¿çš„å®žæ—¶è§†é¢‘æµä¸­çš„å¥èº«æ­¥éª¤çš„ç±»ã€‚"""

    def __init__(self):
        """åˆå§‹åŒ– AIGymï¼Œè®¾ç½®è§†è§‰å’Œå›¾åƒå‚æ•°çš„é»˜è®¤å€¼ã€‚"""
        self.im0 = None  # å½“å‰å¸§å›¾åƒ
        self.tf = None   # çº¿æ¡åŽšåº¦
        self.keypoints = None  # å§¿åŠ¿å…³é”®ç‚¹
        self.poseup_angle = None  # ä¸Šå‡å§¿åŠ¿çš„è§’åº¦é˜ˆå€¼
        self.posedown_angle = None  # ä¸‹é™å§¿åŠ¿çš„è§’åº¦é˜ˆå€¼
        self.threshold = 0.001  # é˜ˆå€¼ï¼Œç”¨äºŽåˆ¤æ–­

        # å­˜å‚¨é˜¶æ®µã€è®¡æ•°å’Œè§’åº¦ä¿¡æ¯
        self.angle = None  # å½“å‰è§’åº¦
        self.count = None  # å½“å‰è®¡æ•°
        self.stage = None  # å½“å‰é˜¶æ®µ
        self.pose_type = "pushup"  # é»˜è®¤å§¿åŠ¿ç±»åž‹
        self.kpts_to_check = None  # éœ€è¦æ£€æŸ¥çš„å…³é”®ç‚¹

        # å¯è§†åŒ–ä¿¡æ¯
        self.view_img = False  # æ˜¯å¦æ˜¾ç¤ºå›¾åƒ
        self.annotator = None  # æ³¨é‡Šå™¨å¯¹è±¡

        # æ£€æŸ¥çŽ¯å¢ƒæ˜¯å¦æ”¯æŒ imshow
        self.env_check = check_imshow(warn=True)

    def set_args(self, kpts_to_check, line_thickness=2, view_img=False, pose_up_angle=145.0, pose_down_angle=90.0, pose_type="pullup"):
        """
        é…ç½® AIGym çš„å‚æ•°
        Args:
            kpts_to_check (list): ç”¨äºŽè®¡æ•°çš„ 3 ä¸ªå…³é”®ç‚¹
            line_thickness (int): è¾¹ç•Œæ¡†çš„çº¿æ¡åŽšåº¦
            view_img (bool): æ˜¯å¦æ˜¾ç¤ºå›¾åƒ
            pose_up_angle (float): è®¾ç½®ä¸Šå‡å§¿åŠ¿çš„è§’åº¦
            pose_down_angle (float): è®¾ç½®ä¸‹é™å§¿åŠ¿çš„è§’åº¦
            pose_type: "pushup", "pullup" æˆ– "abworkout"
        """
        self.kpts_to_check = kpts_to_check  # è®¾ç½®éœ€è¦æ£€æŸ¥çš„å…³é”®ç‚¹
        self.tf = line_thickness  # è®¾ç½®çº¿æ¡åŽšåº¦
        self.view_img = view_img  # è®¾ç½®æ˜¯å¦æ˜¾ç¤ºå›¾åƒ
        self.poseup_angle = pose_up_angle  # è®¾ç½®ä¸Šå‡å§¿åŠ¿çš„è§’åº¦
        self.posedown_angle = pose_down_angle  # è®¾ç½®ä¸‹é™å§¿åŠ¿çš„è§’åº¦
        self.pose_type = pose_type  # è®¾ç½®å§¿åŠ¿ç±»åž‹

    def start_counting(self, im0, results, frame_count):
        """
        è®¡ç®—å¥èº«æ­¥éª¤çš„å‡½æ•°
        Args:
            im0 (ndarray): å½“å‰è§†é¢‘æµçš„å¸§
            results: å§¿åŠ¿ä¼°è®¡æ•°æ®
            frame_count: å½“å‰å¸§è®¡æ•°
        """
        self.im0 = im0  # æ›´æ–°å½“å‰å¸§å›¾åƒ
        if frame_count == 1:
            # åˆå§‹åŒ–è®¡æ•°ã€è§’åº¦å’Œé˜¶æ®µ
            self.count = [0] * len(results[0])
            self.angle = [0] * len(results[0])
            self.stage = ["-" for _ in results[0]]
        
        self.keypoints = results[0].keypoints.data  # èŽ·å–å…³é”®ç‚¹æ•°æ®
        self.annotator = Annotator(im0, line_width=2)  # åˆ›å»ºæ³¨é‡Šå™¨å¯¹è±¡

        num_keypoints = len(results[0])  # å…³é”®ç‚¹æ•°é‡

        # å¦‚æžœå…³é”®ç‚¹æ•°é‡å‘ç”Ÿå˜åŒ–ï¼Œè°ƒæ•´ angleã€count å’Œ stage çš„å¤§å°
        if len(self.angle) != num_keypoints:
            self.angle = [0] * num_keypoints
            self.count = [0] * num_keypoints
            self.stage = ["-" for _ in range(num_keypoints)]

        # éåŽ†æ¯ä¸ªå…³é”®ç‚¹ï¼Œè¿›è¡Œå§¿åŠ¿è§’åº¦ä¼°è®¡å’Œè®¡æ•°
        for ind, k in enumerate(reversed(self.keypoints)):
            # è®¡ç®—å§¿åŠ¿è§’åº¦
            self.angle[ind] = self.annotator.estimate_pose_angle(
                k[int(self.kpts_to_check[0])].cpu(),
                k[int(self.kpts_to_check[1])].cpu(),
                k[int(self.kpts_to_check[2])].cpu(),
            )
            # ç»˜åˆ¶å…³é”®ç‚¹
            self.im0 = self.annotator.draw_specific_points(k, self.kpts_to_check, shape=(640, 640), radius=10)

            # æ ¹æ®å§¿åŠ¿ç±»åž‹æ›´æ–°é˜¶æ®µå’Œè®¡æ•°
            if self.pose_type == "pushup":
                if self.angle[ind] > self.poseup_angle:
                    self.stage[ind] = "up"
                if self.angle[ind] < self.posedown_angle and self.stage[ind] == "up":
                    self.stage[ind] = "down"
                    self.count[ind] += 1

            elif self.pose_type == "pullup":
                if self.angle[ind] > self.poseup_angle:
                    self.stage[ind] = "down"
                if self.angle[ind] < self.posedown_angle and self.stage[ind] == "down":
                    self.stage[ind] = "up"
                    self.count[ind] += 1

            # ç»˜åˆ¶è§’åº¦ã€è®¡æ•°å’Œé˜¶æ®µä¿¡æ¯
            self.annotator.plot_angle_and_count_and_stage(
                angle_text=self.angle[ind],
                count_text=self.count[ind],
                stage_text=self.stage[ind],
                center_kpt=k[int(self.kpts_to_check[1])],
                line_thickness=self.tf,
            )

            # ç»˜åˆ¶æ‰€æœ‰å…³é”®ç‚¹
            self.annotator.kpts(k, shape=(640, 640), radius=1, kpt_line=True)

        # å¦‚æžœçŽ¯å¢ƒæ”¯æŒï¼Œä¸”éœ€è¦æ˜¾ç¤ºå›¾åƒï¼Œåˆ™æ˜¾ç¤ºå½“å‰å¸§
        if self.env_check and self.view_img:
            cv2.imshow("Ultralytics YOLOv8 AI GYM", self.im0)
            if cv2.waitKey(1) & 0xFF == ord("q"):
                return

        return self.im0  # è¿”å›žå½“å‰å¸§å›¾åƒ

# ä¸»ç¨‹åºå…¥å£
if __name__ == "__main__":
    AIGym()  # åˆ›å»º AIGym å®žä¾‹
```

### ä»£ç åˆ†æžï¼š
1. **ç±»çš„å®šä¹‰**ï¼š`AIGym`ç±»ç”¨äºŽç®¡ç†å®žæ—¶è§†é¢‘æµä¸­çš„å¥èº«åŠ¨ä½œè®¡æ•°ã€‚
2. **åˆå§‹åŒ–æ–¹æ³•**ï¼š`__init__`æ–¹æ³•è®¾ç½®äº†å›¾åƒã€å…³é”®ç‚¹ã€è®¡æ•°å’Œé˜¶æ®µç­‰å±žæ€§çš„åˆå§‹å€¼ã€‚
3. **å‚æ•°è®¾ç½®æ–¹æ³•**ï¼š`set_args`æ–¹æ³•ç”¨äºŽé…ç½®å¥èº«åŠ¨ä½œçš„ç›¸å…³å‚æ•°ï¼Œå¦‚å…³é”®ç‚¹ã€çº¿æ¡åŽšåº¦å’Œå§¿åŠ¿ç±»åž‹ã€‚
4. **è®¡æ•°æ–¹æ³•**ï¼š`start_counting`æ–¹æ³•ç”¨äºŽå¤„ç†æ¯ä¸€å¸§å›¾åƒï¼Œè®¡ç®—å§¿åŠ¿è§’åº¦ï¼Œæ›´æ–°è®¡æ•°å’Œé˜¶æ®µï¼Œå¹¶åœ¨å›¾åƒä¸Šç»˜åˆ¶ç›¸å…³ä¿¡æ¯ã€‚
5. **å¯è§†åŒ–**ï¼šä½¿ç”¨`cv2.imshow`æ˜¾ç¤ºå›¾åƒï¼Œæ”¯æŒå®žæ—¶åé¦ˆã€‚

é€šè¿‡è¿™äº›æ ¸å¿ƒéƒ¨åˆ†çš„æç‚¼å’Œæ³¨é‡Šï¼Œå¯ä»¥æ›´å¥½åœ°ç†è§£ä»£ç çš„åŠŸèƒ½å’Œç»“æž„ã€‚

è¿™ä¸ªæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º `AIGym` çš„ç±»ï¼Œä¸»è¦ç”¨äºŽåœ¨å®žæ—¶è§†é¢‘æµä¸­åŸºäºŽäººä½“å§¿æ€ç®¡ç†å¥èº«åŠ¨ä½œçš„è®¡æ•°ã€‚é¦–å…ˆï¼Œç±»çš„æž„é€ å‡½æ•° `__init__` åˆå§‹åŒ–äº†ä¸€äº›é»˜è®¤å€¼ï¼ŒåŒ…æ‹¬å›¾åƒå‚æ•°ã€å…³é”®ç‚¹ä¿¡æ¯ã€è§’åº¦ã€è®¡æ•°ã€é˜¶æ®µç­‰ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜æ£€æŸ¥äº†çŽ¯å¢ƒæ˜¯å¦æ”¯æŒå›¾åƒæ˜¾ç¤ºã€‚

åœ¨ `set_args` æ–¹æ³•ä¸­ï¼Œç”¨æˆ·å¯ä»¥é…ç½®ä¸€äº›å‚æ•°ï¼ŒåŒ…æ‹¬éœ€è¦æ£€æŸ¥çš„å…³é”®ç‚¹ã€çº¿æ¡åŽšåº¦ã€æ˜¯å¦æ˜¾ç¤ºå›¾åƒã€ä¸Šå‡å’Œä¸‹é™å§¿åŠ¿çš„è§’åº¦ï¼Œä»¥åŠåŠ¨ä½œç±»åž‹ï¼ˆå¦‚ä¿¯å§æ’‘ã€å¼•ä½“å‘ä¸Šæˆ–è…¹éƒ¨é”»ç‚¼ï¼‰ã€‚è¿™äº›å‚æ•°å°†å½±å“åŽç»­çš„åŠ¨ä½œè¯†åˆ«å’Œè®¡æ•°ã€‚

`start_counting` æ–¹æ³•æ˜¯è¯¥ç±»çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œç”¨äºŽæ ¹æ®ä¼ å…¥çš„å›¾åƒå¸§å’Œå§¿æ€ä¼°è®¡ç»“æžœæ¥è®¡æ•°å¥èº«åŠ¨ä½œã€‚å®ƒé¦–å…ˆå¤„ç†å½“å‰å¸§çš„å›¾åƒæ•°æ®ï¼Œå¹¶åœ¨ç¬¬ä¸€å¸§æ—¶åˆå§‹åŒ–è®¡æ•°ã€è§’åº¦å’Œé˜¶æ®µçš„åˆ—è¡¨ã€‚ç„¶åŽï¼Œå®ƒæå–å…³é”®ç‚¹æ•°æ®ï¼Œå¹¶ä½¿ç”¨ `Annotator` ç±»æ¥è¿›è¡Œå¯è§†åŒ–å¤„ç†ã€‚

åœ¨å¾ªçŽ¯ä¸­ï¼Œç¨‹åºæ ¹æ®è®¾å®šçš„åŠ¨ä½œç±»åž‹ï¼ˆå¦‚ä¿¯å§æ’‘ã€å¼•ä½“å‘ä¸Šæˆ–è…¹éƒ¨é”»ç‚¼ï¼‰æ¥è®¡ç®—æ¯ä¸ªå…³é”®ç‚¹çš„è§’åº¦ï¼Œå¹¶æ ¹æ®è¿™äº›è§’åº¦åˆ¤æ–­å½“å‰çš„åŠ¨ä½œé˜¶æ®µï¼ˆå¦‚â€œä¸Šâ€æˆ–â€œä¸‹â€ï¼‰ã€‚å¦‚æžœæ£€æµ‹åˆ°åŠ¨ä½œå®Œæˆï¼Œè®¡æ•°å™¨ä¼šå¢žåŠ ã€‚åŒæ—¶ï¼Œç¨‹åºä¼šåœ¨å›¾åƒä¸Šç»˜åˆ¶å…³é”®ç‚¹ã€è§’åº¦ã€è®¡æ•°å’Œé˜¶æ®µä¿¡æ¯ã€‚

æœ€åŽï¼Œå¦‚æžœçŽ¯å¢ƒæ”¯æŒå›¾åƒæ˜¾ç¤ºå¹¶ä¸”è®¾ç½®äº†æ˜¾ç¤ºå›¾åƒçš„é€‰é¡¹ï¼Œç¨‹åºä¼šä½¿ç”¨ OpenCV æ˜¾ç¤ºå¤„ç†åŽçš„å›¾åƒã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡æŒ‰ä¸‹â€œqâ€é”®é€€å‡ºæ˜¾ç¤ºã€‚

æ•´ä½“è€Œè¨€ï¼Œè¿™ä¸ªç±»æä¾›äº†ä¸€ç§é€šè¿‡è§†é¢‘æµå®žæ—¶ç›‘æµ‹å’Œè®¡æ•°å¥èº«åŠ¨ä½œçš„åŠŸèƒ½ï¼Œç»“åˆäº†å§¿æ€ä¼°è®¡å’Œå¯è§†åŒ–æŠ€æœ¯ï¼Œé€‚ç”¨äºŽå¥èº«è®­ç»ƒå’ŒåŠ¨ä½œåˆ†æžç­‰åœºæ™¯ã€‚

#### 11.2 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéžå¿…è¦ï¼‰\ultralytics\nn\backbone\SwinTransformer.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„ä»£ç ï¼Œä¿ç•™äº†æ ¸å¿ƒéƒ¨åˆ†å¹¶è¿›è¡Œäº†è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import torch
import torch.nn as nn
import torch.nn.functional as F
import numpy as np
from timm.models.layers import DropPath, to_2tuple, trunc_normal_

class Mlp(nn.Module):
    """ å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰æ¨¡å—ã€‚ """

    def __init__(self, in_features, hidden_features=None, out_features=None, act_layer=nn.GELU, drop=0.):
        super().__init__()
        out_features = out_features or in_features  # è¾“å‡ºç‰¹å¾æ•°
        hidden_features = hidden_features or in_features  # éšè—å±‚ç‰¹å¾æ•°
        self.fc1 = nn.Linear(in_features, hidden_features)  # ç¬¬ä¸€å±‚çº¿æ€§å˜æ¢
        self.act = act_layer()  # æ¿€æ´»å‡½æ•°
        self.fc2 = nn.Linear(hidden_features, out_features)  # ç¬¬äºŒå±‚çº¿æ€§å˜æ¢
        self.drop = nn.Dropout(drop)  # Dropoutå±‚

    def forward(self, x):
        """ å‰å‘ä¼ æ’­å‡½æ•°ã€‚ """
        x = self.fc1(x)  # çº¿æ€§å˜æ¢
        x = self.act(x)  # æ¿€æ´»
        x = self.drop(x)  # Dropout
        x = self.fc2(x)  # çº¿æ€§å˜æ¢
        x = self.drop(x)  # Dropout
        return x

class WindowAttention(nn.Module):
    """ çª—å£åŸºç¡€çš„å¤šå¤´è‡ªæ³¨æ„åŠ›æ¨¡å—ã€‚ """

    def __init__(self, dim, window_size, num_heads, qkv_bias=True, attn_drop=0., proj_drop=0.):
        super().__init__()
        self.dim = dim  # è¾“å…¥é€šé“æ•°
        self.window_size = window_size  # çª—å£å¤§å°
        self.num_heads = num_heads  # æ³¨æ„åŠ›å¤´æ•°
        head_dim = dim // num_heads  # æ¯ä¸ªå¤´çš„ç»´åº¦
        self.scale = head_dim ** -0.5  # ç¼©æ”¾å› å­

        # å®šä¹‰ç›¸å¯¹ä½ç½®åç½®å‚æ•°
        self.relative_position_bias_table = nn.Parameter(
            torch.zeros((2 * window_size[0] - 1) * (2 * window_size[1] - 1), num_heads))

        # è®¡ç®—ç›¸å¯¹ä½ç½®ç´¢å¼•
        coords_h = torch.arange(self.window_size[0])
        coords_w = torch.arange(self.window_size[1])
        coords = torch.stack(torch.meshgrid([coords_h, coords_w]))  # ç”Ÿæˆåæ ‡ç½‘æ ¼
        coords_flatten = torch.flatten(coords, 1)  # å±•å¹³åæ ‡
        relative_coords = coords_flatten[:, :, None] - coords_flatten[:, None, :]  # è®¡ç®—ç›¸å¯¹åæ ‡
        relative_coords = relative_coords.permute(1, 2, 0).contiguous()  # è°ƒæ•´ç»´åº¦
        relative_coords[:, :, 0] += self.window_size[0] - 1  # ç§»åŠ¨åˆ°0å¼€å§‹
        relative_coords[:, :, 1] += self.window_size[1] - 1
        relative_coords[:, :, 0] *= 2 * self.window_size[1] - 1
        self.register_buffer("relative_position_index", relative_coords.sum(-1))  # æ³¨å†Œç›¸å¯¹ä½ç½®ç´¢å¼•

        self.qkv = nn.Linear(dim, dim * 3, bias=qkv_bias)  # çº¿æ€§å˜æ¢ç”ŸæˆQ, K, V
        self.attn_drop = nn.Dropout(attn_drop)  # æ³¨æ„åŠ›çš„Dropout
        self.proj = nn.Linear(dim, dim)  # è¾“å‡ºçº¿æ€§å˜æ¢
        self.proj_drop = nn.Dropout(proj_drop)  # è¾“å‡ºçš„Dropout
        trunc_normal_(self.relative_position_bias_table, std=.02)  # åˆå§‹åŒ–ç›¸å¯¹ä½ç½®åç½®
        self.softmax = nn.Softmax(dim=-1)  # Softmaxå±‚

    def forward(self, x, mask=None):
        """ å‰å‘ä¼ æ’­å‡½æ•°ã€‚ """
        B_, N, C = x.shape  # B_: æ‰¹é‡å¤§å°, N: åºåˆ—é•¿åº¦, C: é€šé“æ•°
        qkv = self.qkv(x).reshape(B_, N, 3, self.num_heads, C // self.num_heads).permute(2, 0, 3, 1, 4)
        q, k, v = qkv[0], qkv[1], qkv[2]  # èŽ·å–Q, K, V

        q = q * self.scale  # ç¼©æ”¾Q
        attn = (q @ k.transpose(-2, -1))  # è®¡ç®—æ³¨æ„åŠ›æƒé‡

        # æ·»åŠ ç›¸å¯¹ä½ç½®åç½®
        relative_position_bias = self.relative_position_bias_table[self.relative_position_index.view(-1)].view(
            self.window_size[0] * self.window_size[1], self.window_size[0] * self.window_size[1], -1)
        relative_position_bias = relative_position_bias.permute(2, 0, 1).contiguous()  # è°ƒæ•´ç»´åº¦
        attn = attn + relative_position_bias.unsqueeze(0)  # åŠ å…¥ç›¸å¯¹ä½ç½®åç½®

        if mask is not None:
            attn = attn.view(B_ // mask.shape[0], mask.shape[0], self.num_heads, N, N) + mask.unsqueeze(1).unsqueeze(0)
            attn = attn.view(-1, self.num_heads, N, N)
            attn = self.softmax(attn)  # åº”ç”¨Softmax
        else:
            attn = self.softmax(attn)

        attn = self.attn_drop(attn)  # Dropout

        x = (attn @ v).transpose(1, 2).reshape(B_, N, C)  # åº”ç”¨æ³¨æ„åŠ›æƒé‡
        x = self.proj(x)  # è¾“å‡ºçº¿æ€§å˜æ¢
        x = self.proj_drop(x)  # Dropout
        return x

class SwinTransformer(nn.Module):
    """ Swin Transformerä¸»å¹²ç½‘ç»œã€‚ """

    def __init__(self, patch_size=4, in_chans=3, embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24]):
        super().__init__()
        self.patch_embed = PatchEmbed(patch_size=patch_size, in_chans=in_chans, embed_dim=embed_dim)  # å›¾åƒåˆ†å—åµŒå…¥
        self.layers = nn.ModuleList()  # å­˜å‚¨æ¯ä¸€å±‚

        # æž„å»ºæ¯ä¸€å±‚
        for i_layer in range(len(depths)):
            layer = BasicLayer(
                dim=int(embed_dim * 2 ** i_layer),
                depth=depths[i_layer],
                num_heads=num_heads[i_layer],
                window_size=7,  # çª—å£å¤§å°
                mlp_ratio=4.0)  # MLPæ¯”ä¾‹
            self.layers.append(layer)

    def forward(self, x):
        """ å‰å‘ä¼ æ’­å‡½æ•°ã€‚ """
        x = self.patch_embed(x)  # å›¾åƒåˆ†å—åµŒå…¥
        for layer in self.layers:
            x, _, _, _, _, _ = layer(x, x.size(1), x.size(2))  # é€å±‚å‰å‘ä¼ æ’­
        return x  # è¿”å›žæœ€ç»ˆè¾“å‡º

def SwinTransformer_Tiny(weights=''):
    """ åˆ›å»ºä¸€ä¸ªå°åž‹çš„Swin Transformeræ¨¡åž‹ã€‚ """
    model = SwinTransformer(depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24])  # åˆå§‹åŒ–æ¨¡åž‹
    if weights:
        model.load_state_dict(torch.load(weights)['model'])  # åŠ è½½æƒé‡
    return model
```

### ä¸»è¦æ”¹åŠ¨å’Œæ³¨é‡Šè¯´æ˜Žï¼š
1. **Mlpç±»**ï¼šå®žçŽ°äº†ä¸€ä¸ªç®€å•çš„å¤šå±‚æ„ŸçŸ¥æœºï¼ŒåŒ…å«ä¸¤ä¸ªçº¿æ€§å±‚å’Œæ¿€æ´»å‡½æ•°ã€‚
2. **WindowAttentionç±»**ï¼šå®žçŽ°äº†çª—å£åŸºç¡€çš„å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œæ”¯æŒç›¸å¯¹ä½ç½®åç½®ã€‚
3. **SwinTransformerç±»**ï¼šå®žçŽ°äº†Swin Transformerçš„ä¸»å¹²ç½‘ç»œï¼ŒåŒ…å«å›¾åƒåˆ†å—åµŒå…¥å’Œå¤šä¸ªåŸºæœ¬å±‚ã€‚
4. **SwinTransformer_Tinyå‡½æ•°**ï¼šç”¨äºŽåˆ›å»ºä¸€ä¸ªå°åž‹çš„Swin Transformeræ¨¡åž‹ï¼Œå¹¶å¯é€‰æ‹©åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚

æ³¨é‡Šè¯¦ç»†è¯´æ˜Žäº†æ¯ä¸ªæ¨¡å—çš„åŠŸèƒ½å’Œè¾“å…¥è¾“å‡ºï¼Œå¸®åŠ©ç†è§£æ¨¡åž‹çš„ç»“æž„å’Œå·¥ä½œåŽŸç†ã€‚

è¯¥ç¨‹åºæ–‡ä»¶å®žçŽ°äº†Swin Transformeræ¨¡åž‹çš„æ ¸å¿ƒç»„ä»¶ï¼Œä¸»è¦ç”¨äºŽè®¡ç®—æœºè§†è§‰ä»»åŠ¡ä¸­çš„ç‰¹å¾æå–ã€‚Swin Transformeræ˜¯ä¸€ç§åŸºäºŽTransformeræž¶æž„çš„è§†è§‰æ¨¡åž‹ï¼Œé€šè¿‡åˆ†å±‚çš„æ–¹å¼å’Œçª—å£æ³¨æ„åŠ›æœºåˆ¶æ¥å¤„ç†å›¾åƒæ•°æ®ã€‚

æ–‡ä»¶ä¸­é¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬PyTorchçš„ç¥žç»ç½‘ç»œæ¨¡å—å’Œä¸€äº›è¾…åŠ©å‡½æ•°ã€‚æŽ¥ç€å®šä¹‰äº†ä¸€ä¸ªå¤šå±‚æ„ŸçŸ¥æœºï¼ˆMlpï¼‰ç±»ï¼Œè¯¥ç±»åŒ…å«ä¸¤ä¸ªå…¨è¿žæŽ¥å±‚å’Œä¸€ä¸ªæ¿€æ´»å‡½æ•°ï¼Œé€šå¸¸ç”¨äºŽç‰¹å¾çš„éžçº¿æ€§å˜æ¢ã€‚

æŽ¥ä¸‹æ¥ï¼Œå®šä¹‰äº†çª—å£åˆ’åˆ†å’Œçª—å£åè½¬çš„å‡½æ•°ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°ç”¨äºŽå°†è¾“å…¥ç‰¹å¾å›¾åˆ’åˆ†ä¸ºå°çª—å£ï¼Œå¹¶åœ¨è®¡ç®—æ³¨æ„åŠ›æ—¶å°†çª—å£åˆå¹¶å›žåŽŸæ¥çš„å½¢çŠ¶ã€‚çª—å£æ³¨æ„åŠ›ï¼ˆWindowAttentionï¼‰æ¨¡å—æ˜¯Swin Transformerçš„æ ¸å¿ƒï¼Œæ”¯æŒç›¸å¯¹ä½ç½®åç½®ï¼Œå¹¶å®žçŽ°äº†çª—å£å†…çš„å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶ã€‚

Swin Transformer Blockç±»å®žçŽ°äº†Swin Transformerçš„åŸºæœ¬æž„å»ºå—ï¼ŒåŒ…æ‹¬è§„èŒƒåŒ–ã€çª—å£æ³¨æ„åŠ›è®¡ç®—å’Œå‰é¦ˆç½‘ç»œï¼ˆFFNï¼‰ã€‚è¯¥å—æ”¯æŒçª—å£çš„å¾ªçŽ¯ä½ç§»ï¼Œä»¥å¢žå¼ºæ¨¡åž‹çš„ä¸Šä¸‹æ–‡æ„ŸçŸ¥èƒ½åŠ›ã€‚

PatchMergingç±»ç”¨äºŽå°†ç‰¹å¾å›¾ä¸­çš„å°å—åˆå¹¶ä¸ºæ›´å¤§çš„å—ï¼Œä»¥é™ä½Žç‰¹å¾å›¾çš„åˆ†è¾¨çŽ‡ã€‚BasicLayerç±»åˆ™æ˜¯ä¸€ä¸ªSwin Transformerçš„åŸºæœ¬å±‚ï¼ŒåŒ…å«å¤šä¸ªSwin Transformer Blockï¼Œå¹¶åœ¨å¿…è¦æ—¶è¿›è¡Œä¸‹é‡‡æ ·ã€‚

PatchEmbedç±»è´Ÿè´£å°†è¾“å…¥å›¾åƒåˆ†å‰²æˆå°å—å¹¶è¿›è¡ŒåµŒå…¥ï¼Œç”Ÿæˆåˆå§‹çš„ç‰¹å¾è¡¨ç¤ºã€‚SwinTransformerç±»åˆ™æ˜¯æ•´ä¸ªæ¨¡åž‹çš„å°è£…ï¼Œå®šä¹‰äº†æ¨¡åž‹çš„ç»“æž„ï¼ŒåŒ…æ‹¬å„å±‚çš„æ·±åº¦ã€å¤´æ•°ã€çª—å£å¤§å°ç­‰è¶…å‚æ•°ï¼Œå¹¶å®žçŽ°äº†å‰å‘ä¼ æ’­è¿‡ç¨‹ã€‚

æœ€åŽï¼Œå®šä¹‰äº†ä¸€ä¸ªç”¨äºŽåŠ è½½é¢„è®­ç»ƒæƒé‡çš„å‡½æ•°å’Œä¸€ä¸ªåˆ›å»ºå°åž‹Swin Transformeræ¨¡åž‹çš„å‡½æ•°ï¼ˆSwinTransformer_Tinyï¼‰ï¼Œå¯ä»¥æ ¹æ®éœ€è¦åŠ è½½æƒé‡ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥æ–‡ä»¶å®žçŽ°äº†Swin Transformerçš„ä¸»è¦ç»“æž„å’ŒåŠŸèƒ½ï¼Œé€‚ç”¨äºŽå„ç§è§†è§‰ä»»åŠ¡ï¼Œå¦‚å›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹ç­‰ã€‚é€šè¿‡ä½¿ç”¨çª—å£æ³¨æ„åŠ›æœºåˆ¶ï¼Œè¯¥æ¨¡åž‹åœ¨è®¡ç®—æ•ˆçŽ‡å’Œæ€§èƒ½ä¸Šéƒ½æœ‰æ˜¾è‘—æå‡ã€‚

#### 11.3 code\ultralytics\trackers\utils\__init__.py

```python
# Ultralytics YOLO ðŸš€, AGPL-3.0 license

# è¿™æ®µä»£ç æ˜¯å…³äºŽUltralytics YOLOï¼ˆYou Only Look Onceï¼‰ç›®æ ‡æ£€æµ‹æ¨¡åž‹çš„åŸºç¡€æ¡†æž¶ã€‚
# YOLOæ˜¯ä¸€ç§å®žæ—¶ç›®æ ‡æ£€æµ‹ç³»ç»Ÿï¼Œèƒ½å¤Ÿå¿«é€Ÿè€Œå‡†ç¡®åœ°è¯†åˆ«å›¾åƒä¸­çš„å¤šä¸ªå¯¹è±¡ã€‚

# ä¸‹é¢æ˜¯æ ¸å¿ƒéƒ¨åˆ†çš„ä¼ªä»£ç ï¼ŒåŒ…å«YOLOæ¨¡åž‹çš„åˆå§‹åŒ–å’ŒæŽ¨ç†è¿‡ç¨‹ã€‚

class YOLO:
    def __init__(self, model_path):
        # åˆå§‹åŒ–YOLOæ¨¡åž‹
        # model_path: æ¨¡åž‹æ–‡ä»¶çš„è·¯å¾„
        self.model = self.load_model(model_path)  # åŠ è½½é¢„è®­ç»ƒæ¨¡åž‹

    def load_model(self, model_path):
        # åŠ è½½æ¨¡åž‹çš„å…·ä½“å®žçŽ°
        # è¿™é‡Œå¯ä»¥æ˜¯åŠ è½½æƒé‡æ–‡ä»¶å’Œé…ç½®æ–‡ä»¶
        pass

    def predict(self, image):
        # å¯¹è¾“å…¥å›¾åƒè¿›è¡Œç›®æ ‡æ£€æµ‹
        # image: è¾“å…¥çš„å›¾åƒæ•°æ®
        detections = self.model.detect(image)  # ä½¿ç”¨æ¨¡åž‹è¿›è¡ŒæŽ¨ç†
        return detections  # è¿”å›žæ£€æµ‹ç»“æžœ

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    yolo = YOLO("path/to/model")  # åˆ›å»ºYOLOå¯¹è±¡å¹¶åŠ è½½æ¨¡åž‹
    image = "path/to/image.jpg"  # è¾“å…¥å›¾åƒè·¯å¾„
    results = yolo.predict(image)  # è¿›è¡Œç›®æ ‡æ£€æµ‹
    print(results)  # è¾“å‡ºæ£€æµ‹ç»“æžœ
```

### è¯¦ç»†æ³¨é‡Šï¼š
1. **YOLOç±»**ï¼šè¿™æ˜¯YOLOæ¨¡åž‹çš„æ ¸å¿ƒç±»ï¼Œè´Ÿè´£æ¨¡åž‹çš„åˆå§‹åŒ–å’ŒæŽ¨ç†ã€‚
2. **`__init__`æ–¹æ³•**ï¼šæž„é€ å‡½æ•°ï¼Œç”¨äºŽåˆ›å»ºYOLOå¯¹è±¡å¹¶åŠ è½½æŒ‡å®šè·¯å¾„çš„æ¨¡åž‹ã€‚
3. **`load_model`æ–¹æ³•**ï¼šè´Ÿè´£åŠ è½½æ¨¡åž‹çš„å…·ä½“å®žçŽ°ï¼Œé€šå¸¸åŒ…æ‹¬è¯»å–æ¨¡åž‹çš„æƒé‡å’Œé…ç½®ã€‚
4. **`predict`æ–¹æ³•**ï¼šæŽ¥å—è¾“å…¥å›¾åƒå¹¶ä½¿ç”¨æ¨¡åž‹è¿›è¡Œç›®æ ‡æ£€æµ‹ï¼Œè¿”å›žæ£€æµ‹åˆ°çš„å¯¹è±¡ä¿¡æ¯ã€‚
5. **ä½¿ç”¨ç¤ºä¾‹**ï¼šåœ¨ä¸»ç¨‹åºä¸­åˆ›å»ºYOLOå¯¹è±¡ï¼ŒåŠ è½½æ¨¡åž‹ï¼Œå¹¶å¯¹æŒ‡å®šå›¾åƒè¿›è¡Œç›®æ ‡æ£€æµ‹ï¼Œæœ€åŽè¾“å‡ºç»“æžœã€‚

è¿™ä¸ªæ–‡ä»¶æ˜¯Ultralytics YOLOé¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦ç”¨äºŽç›®æ ‡æ£€æµ‹å’Œè·Ÿè¸ªã€‚æ–‡ä»¶çš„å¼€å¤´åŒ…å«äº†ä¸€ä¸ªæ³¨é‡Šï¼Œè¡¨æ˜Žè¯¥é¡¹ç›®éµå¾ªAGPL-3.0è®¸å¯è¯ã€‚è¿™æ„å‘³ç€ç”¨æˆ·å¯ä»¥è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†å‘è¯¥ä»£ç ï¼Œä½†éœ€è¦éµå¾ªç›¸åº”çš„è®¸å¯è¯æ¡æ¬¾ã€‚

è™½ç„¶æ–‡ä»¶å†…å®¹æ²¡æœ‰å…·ä½“çš„ä»£ç å±•ç¤ºï¼Œä½†æ ¹æ®æ–‡ä»¶åå’Œè·¯å¾„æŽ¨æµ‹ï¼Œè¿™ä¸ª`__init__.py`æ–‡ä»¶çš„ä½œç”¨é€šå¸¸æ˜¯å°†`trackers`æ¨¡å—æ ‡è®°ä¸ºä¸€ä¸ªPythonåŒ…ï¼Œä½¿å¾—è¯¥ç›®å½•ä¸‹çš„å…¶ä»–æ¨¡å—å¯ä»¥è¢«å¯¼å…¥å’Œä½¿ç”¨ã€‚é€šå¸¸åœ¨`__init__.py`æ–‡ä»¶ä¸­ï¼Œå¼€å‘è€…ä¼šåˆå§‹åŒ–åŒ…çš„å‘½åç©ºé—´ï¼Œå¯èƒ½ä¼šå¯¼å…¥ä¸€äº›å¸¸ç”¨çš„ç±»æˆ–å‡½æ•°ï¼Œä»¥ä¾¿ç”¨æˆ·åœ¨ä½¿ç”¨è¯¥åŒ…æ—¶èƒ½å¤Ÿæ–¹ä¾¿åœ°è®¿é—®ã€‚

åœ¨YOLOé¡¹ç›®ä¸­ï¼Œè·Ÿè¸ªå™¨æ¨¡å—å¯èƒ½æ¶‰åŠåˆ°å¤šç›®æ ‡è·Ÿè¸ªçš„åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·åœ¨è§†é¢‘æµä¸­è¯†åˆ«å’Œè·Ÿè¸ªå¤šä¸ªå¯¹è±¡ã€‚è¿™å¯¹äºŽå®žæ—¶ç›‘æŽ§ã€è§†é¢‘åˆ†æžç­‰åº”ç”¨åœºæ™¯éžå¸¸é‡è¦ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯Ultralytics YOLOé¡¹ç›®ä¸­è·Ÿè¸ªå™¨åŠŸèƒ½çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå°½ç®¡å…·ä½“çš„å®žçŽ°ç»†èŠ‚åœ¨æ­¤æ–‡ä»¶ä¸­å¹¶æœªä½“çŽ°ï¼Œä½†å®ƒä¸ºæ•´ä¸ªæ¨¡å—çš„ä½¿ç”¨å’Œç»„ç»‡æä¾›äº†åŸºç¡€ã€‚

#### 11.4 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéžå¿…è¦ï¼‰\ultralytics\engine\predictor.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
class BasePredictor:
    """
    BasePredictor ç±»ç”¨äºŽåˆ›å»ºé¢„æµ‹å™¨çš„åŸºç±»ã€‚

    å±žæ€§:
        args (SimpleNamespace): é¢„æµ‹å™¨çš„é…ç½®ã€‚
        save_dir (Path): ä¿å­˜ç»“æžœçš„ç›®å½•ã€‚
        model (nn.Module): ç”¨äºŽé¢„æµ‹çš„æ¨¡åž‹ã€‚
        device (torch.device): ç”¨äºŽé¢„æµ‹çš„è®¾å¤‡ã€‚
        dataset (Dataset): ç”¨äºŽé¢„æµ‹çš„æ•°æ®é›†ã€‚
    """

    def __init__(self, cfg=DEFAULT_CFG, overrides=None, _callbacks=None):
        """
        åˆå§‹åŒ– BasePredictor ç±»ã€‚

        å‚æ•°:
            cfg (str, optional): é…ç½®æ–‡ä»¶çš„è·¯å¾„ï¼Œé»˜è®¤ä¸º DEFAULT_CFGã€‚
            overrides (dict, optional): é…ç½®è¦†ç›–ï¼Œé»˜è®¤ä¸º Noneã€‚
        """
        self.args = get_cfg(cfg, overrides)  # èŽ·å–é…ç½®
        self.save_dir = get_save_dir(self.args)  # èŽ·å–ä¿å­˜ç›®å½•
        self.done_warmup = False  # æ˜¯å¦å®Œæˆé¢„çƒ­
        self.model = None  # æ¨¡åž‹åˆå§‹åŒ–ä¸º None
        self.device = None  # è®¾å¤‡åˆå§‹åŒ–ä¸º None
        self.dataset = None  # æ•°æ®é›†åˆå§‹åŒ–ä¸º None
        self.callbacks = _callbacks or callbacks.get_default_callbacks()  # å›žè°ƒå‡½æ•°åˆå§‹åŒ–

    def preprocess(self, im):
        """
        åœ¨æŽ¨ç†ä¹‹å‰å‡†å¤‡è¾“å…¥å›¾åƒã€‚

        å‚æ•°:
            im (torch.Tensor | List(np.ndarray)): è¾“å…¥å›¾åƒï¼Œæ”¯æŒå¼ é‡æˆ–åˆ—è¡¨æ ¼å¼ã€‚
        
        è¿”å›ž:
            torch.Tensor: å¤„ç†åŽçš„å›¾åƒå¼ é‡ã€‚
        """
        not_tensor = not isinstance(im, torch.Tensor)  # æ£€æŸ¥è¾“å…¥æ˜¯å¦ä¸ºå¼ é‡
        if not_tensor:
            im = np.stack(self.pre_transform(im))  # é¢„å¤„ç†å›¾åƒ
            im = im[..., ::-1].transpose((0, 3, 1, 2))  # è½¬æ¢ä¸º BCHW æ ¼å¼
            im = np.ascontiguousarray(im)  # ç¡®ä¿æ•°ç»„æ˜¯è¿žç»­çš„
            im = torch.from_numpy(im)  # è½¬æ¢ä¸ºå¼ é‡

        im = im.to(self.device)  # å°†å›¾åƒç§»åŠ¨åˆ°æŒ‡å®šè®¾å¤‡
        im = im.half() if self.model.fp16 else im.float()  # è½¬æ¢æ•°æ®ç±»åž‹
        if not_tensor:
            im /= 255  # å°†åƒç´ å€¼å½’ä¸€åŒ–åˆ° [0.0, 1.0]
        return im

    def inference(self, im, *args, **kwargs):
        """å¯¹ç»™å®šå›¾åƒè¿›è¡ŒæŽ¨ç†ã€‚"""
        return self.model(im, augment=self.args.augment)  # ä½¿ç”¨æ¨¡åž‹è¿›è¡ŒæŽ¨ç†

    def stream_inference(self, source=None, model=None, *args, **kwargs):
        """å¯¹æ‘„åƒå¤´å®žæ—¶æµè¿›è¡ŒæŽ¨ç†å¹¶ä¿å­˜ç»“æžœã€‚"""
        if not self.model:
            self.setup_model(model)  # è®¾ç½®æ¨¡åž‹

        self.setup_source(source if source is not None else self.args.source)  # è®¾ç½®æ•°æ®æº

        for batch in self.dataset:  # éåŽ†æ•°æ®é›†
            path, im0s, vid_cap, s = batch  # è§£åŒ…æ•°æ®
            im = self.preprocess(im0s)  # é¢„å¤„ç†å›¾åƒ
            preds = self.inference(im, *args, **kwargs)  # è¿›è¡ŒæŽ¨ç†
            self.results = self.postprocess(preds, im, im0s)  # åŽå¤„ç†ç»“æžœ

            for i in range(len(im0s)):
                self.write_results(i, self.results, (path[i], im, im0s[i]))  # å†™å…¥ç»“æžœ

            yield from self.results  # ç”Ÿæˆç»“æžœ

    def setup_model(self, model, verbose=True):
        """åˆå§‹åŒ– YOLO æ¨¡åž‹å¹¶è®¾ç½®ä¸ºè¯„ä¼°æ¨¡å¼ã€‚"""
        self.model = AutoBackend(model or self.args.model, device=select_device(self.args.device, verbose=verbose))
        self.device = self.model.device  # æ›´æ–°è®¾å¤‡
        self.model.eval()  # è®¾ç½®æ¨¡åž‹ä¸ºè¯„ä¼°æ¨¡å¼

    def write_results(self, idx, results, batch):
        """å°†æŽ¨ç†ç»“æžœå†™å…¥æ–‡ä»¶æˆ–ç›®å½•ã€‚"""
        p, im, _ = batch  # è§£åŒ…æ‰¹æ¬¡æ•°æ®
        result = results[idx]  # èŽ·å–å½“å‰ç»“æžœ
        # å¤„ç†ä¿å­˜å’Œæ˜¾ç¤ºé€»è¾‘
        if self.args.save_txt:
            result.save_txt(f'{self.save_dir / "labels" / p.stem}.txt')  # ä¿å­˜æ–‡æœ¬ç»“æžœ
        return f'{idx}: {result.verbose()}'  # è¿”å›žæ—¥å¿—å­—ç¬¦ä¸²
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜Žï¼š
1. **BasePredictor ç±»**ï¼šè¿™æ˜¯ä¸€ä¸ªåŸºç±»ï¼Œç”¨äºŽå®žçŽ°é¢„æµ‹å™¨çš„åŸºæœ¬åŠŸèƒ½ï¼ŒåŒ…æ‹¬åˆå§‹åŒ–ã€é¢„å¤„ç†ã€æŽ¨ç†å’Œç»“æžœå†™å…¥ç­‰ã€‚
2. **__init__ æ–¹æ³•**ï¼šåˆå§‹åŒ–ç±»çš„å±žæ€§ï¼ŒåŒ…æ‹¬é…ç½®ã€ä¿å­˜ç›®å½•ã€æ¨¡åž‹ã€è®¾å¤‡ç­‰ã€‚
3. **preprocess æ–¹æ³•**ï¼šå¯¹è¾“å…¥å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼Œç¡®ä¿å…¶æ ¼å¼å’Œæ•°æ®ç±»åž‹é€‚åˆæ¨¡åž‹è¾“å…¥ã€‚
4. **inference æ–¹æ³•**ï¼šä½¿ç”¨æ¨¡åž‹å¯¹é¢„å¤„ç†åŽçš„å›¾åƒè¿›è¡ŒæŽ¨ç†ã€‚
5. **stream_inference æ–¹æ³•**ï¼šå¤„ç†å®žæ—¶æµçš„æŽ¨ç†ï¼ŒéåŽ†æ•°æ®é›†å¹¶ç”ŸæˆæŽ¨ç†ç»“æžœã€‚
6. **setup_model æ–¹æ³•**ï¼šåˆå§‹åŒ– YOLO æ¨¡åž‹å¹¶è®¾ç½®ä¸ºè¯„ä¼°æ¨¡å¼ã€‚
7. **write_results æ–¹æ³•**ï¼šå°†æŽ¨ç†ç»“æžœå†™å…¥æ–‡ä»¶æˆ–ç›®å½•ï¼Œæ”¯æŒä¿å­˜æ–‡æœ¬æ ¼å¼çš„ç»“æžœã€‚

è¿™äº›æ–¹æ³•å’Œç±»çš„ç»„åˆå®žçŽ°äº†å¯¹å›¾åƒã€è§†é¢‘æµç­‰å¤šç§è¾“å…¥æºçš„æŽ¨ç†å¤„ç†ï¼Œæ ¸å¿ƒåŠŸèƒ½é›†ä¸­åœ¨æ¨¡åž‹çš„åŠ è½½ã€æ•°æ®çš„é¢„å¤„ç†ã€æŽ¨ç†è¿‡ç¨‹å’Œç»“æžœçš„ä¿å­˜ä¸Šã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯ä¸€ä¸ªç”¨äºŽYOLOv8æ¨¡åž‹è¿›è¡Œé¢„æµ‹çš„åŸºç¡€ç±»ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å¤„ç†å›¾åƒã€è§†é¢‘ã€æµåª’ä½“ç­‰è¾“å…¥æºï¼Œå¹¶å¯¹å…¶è¿›è¡ŒæŽ¨ç†ã€‚æ–‡ä»¶ä¸­åŒ…å«äº†è¯¦ç»†çš„æ³¨é‡Šå’Œè¯´æ˜Žï¼Œä¾¿äºŽç”¨æˆ·ç†è§£å¦‚ä½•ä½¿ç”¨è¯¥ç±»è¿›è¡Œé¢„æµ‹ã€‚

é¦–å…ˆï¼Œæ–‡ä»¶å¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬`cv2`ã€`numpy`å’Œ`torch`ç­‰ï¼Œè¿™äº›åº“æä¾›äº†å›¾åƒå¤„ç†å’Œæ·±åº¦å­¦ä¹ æ‰€éœ€çš„åŠŸèƒ½ã€‚æŽ¥ç€ï¼Œæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º`BasePredictor`çš„ç±»ï¼Œè¯¥ç±»æ˜¯è¿›è¡Œé¢„æµ‹çš„åŸºç¡€ç±»ï¼ŒåŒ…å«å¤šä¸ªæ–¹æ³•å’Œå±žæ€§ã€‚

åœ¨ç±»çš„åˆå§‹åŒ–æ–¹æ³•ä¸­ï¼Œé…ç½®å‚æ•°è¢«è¯»å–å¹¶å­˜å‚¨ï¼Œé»˜è®¤çš„ç½®ä¿¡åº¦è¢«è®¾ç½®ä¸º0.25ã€‚ç±»ä¸­å®šä¹‰äº†ä¸€äº›é‡è¦çš„å±žæ€§ï¼Œä¾‹å¦‚æ¨¡åž‹ã€æ•°æ®é›†ã€è®¾å¤‡ç­‰ï¼Œè¿™äº›å±žæ€§å°†åœ¨åŽç»­çš„æŽ¨ç†è¿‡ç¨‹ä¸­ä½¿ç”¨ã€‚

`preprocess`æ–¹æ³•ç”¨äºŽå¯¹è¾“å…¥å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å°†å›¾åƒè½¬æ¢ä¸ºå¼ é‡æ ¼å¼ã€è°ƒæ•´æ•°æ®ç±»åž‹ç­‰ã€‚`inference`æ–¹æ³•åˆ™æ˜¯å®žé™…è¿›è¡ŒæŽ¨ç†çš„åœ°æ–¹ï¼Œå®ƒè°ƒç”¨æ¨¡åž‹å¯¹é¢„å¤„ç†åŽçš„å›¾åƒè¿›è¡Œé¢„æµ‹ã€‚`postprocess`æ–¹æ³•ç”¨äºŽå¯¹é¢„æµ‹ç»“æžœè¿›è¡ŒåŽå¤„ç†ã€‚

ç±»ä¸­è¿˜æœ‰ä¸€ä¸ª`write_results`æ–¹æ³•ï¼Œç”¨äºŽå°†æŽ¨ç†ç»“æžœå†™å…¥æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¹¶å¯é€‰æ‹©æ€§åœ°å°†è¾¹ç•Œæ¡†ç»˜åˆ¶åˆ°å›¾åƒä¸Šã€‚`show`æ–¹æ³•ç”¨äºŽä½¿ç”¨OpenCVæ˜¾ç¤ºå›¾åƒï¼Œ`save_preds`æ–¹æ³•åˆ™ç”¨äºŽå°†é¢„æµ‹ç»“æžœä¿å­˜ä¸ºè§†é¢‘æ–‡ä»¶ã€‚

`stream_inference`æ–¹æ³•æ˜¯ä¸€ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼Œå®ƒå¤„ç†å®žæ—¶æŽ¨ç†ï¼Œèƒ½å¤Ÿä»Žæ‘„åƒå¤´æˆ–è§†é¢‘æµä¸­èŽ·å–è¾“å…¥ï¼Œå¹¶è¿›è¡Œé€å¸§å¤„ç†ã€‚è¯¥æ–¹æ³•ä¸­åŒ…å«äº†æ¨¡åž‹çš„åˆå§‹åŒ–ã€æ•°æ®æºçš„è®¾ç½®ã€æŽ¨ç†è¿‡ç¨‹çš„å¾ªçŽ¯ç­‰é€»è¾‘ã€‚

æ­¤å¤–ï¼Œç±»ä¸­è¿˜æä¾›äº†å›žè°ƒæœºåˆ¶ï¼Œå…è®¸ç”¨æˆ·åœ¨ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶æ‰§è¡Œè‡ªå®šä¹‰å‡½æ•°ã€‚è¿™ç§è®¾è®¡ä½¿å¾—è¯¥ç±»å…·æœ‰è¾ƒé«˜çš„çµæ´»æ€§ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦æ‰©å±•åŠŸèƒ½ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¿™ä¸ªæ–‡ä»¶æä¾›äº†YOLOv8æ¨¡åž‹è¿›è¡ŒæŽ¨ç†çš„åŸºç¡€æ¡†æž¶ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚è¿›è¡Œæ‰©å±•å’Œä¿®æ”¹ã€‚é€šè¿‡åˆç†é…ç½®å‚æ•°å’Œä½¿ç”¨ä¸åŒçš„è¾“å…¥æºï¼Œç”¨æˆ·å¯ä»¥å®žçŽ°å¤šç§åº”ç”¨åœºæ™¯ä¸‹çš„ç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚

#### 11.5 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéžå¿…è¦ï¼‰\ultralytics\models\yolo\detect\train.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼š

```python
# å¯¼å…¥å¿…è¦çš„åº“
from copy import copy
import numpy as np
from ultralytics.data import build_dataloader, build_yolo_dataset
from ultralytics.engine.trainer import BaseTrainer
from ultralytics.models import yolo
from ultralytics.nn.tasks import DetectionModel
from ultralytics.utils import LOGGER, RANK
from ultralytics.utils.torch_utils import de_parallel, torch_distributed_zero_first

class DetectionTrainer(BaseTrainer):
    """
    DetectionTrainerç±»ï¼Œç»§æ‰¿è‡ªBaseTrainerï¼Œç”¨äºŽåŸºäºŽæ£€æµ‹æ¨¡åž‹çš„è®­ç»ƒã€‚
    """

    def build_dataset(self, img_path, mode='train', batch=None):
        """
        æž„å»ºYOLOæ•°æ®é›†ã€‚

        å‚æ•°:
            img_path (str): åŒ…å«å›¾åƒçš„æ–‡ä»¶å¤¹è·¯å¾„ã€‚
            mode (str): æ¨¡å¼ï¼Œå¯ä»¥æ˜¯'train'æˆ–'val'ï¼Œç”¨æˆ·å¯ä»¥ä¸ºæ¯ç§æ¨¡å¼è‡ªå®šä¹‰ä¸åŒçš„å¢žå¼ºã€‚
            batch (int, optional): æ‰¹æ¬¡å¤§å°ï¼Œä»…ç”¨äºŽ'rect'æ¨¡å¼ã€‚é»˜è®¤ä¸ºNoneã€‚
        """
        # èŽ·å–æ¨¡åž‹çš„æœ€å¤§æ­¥å¹…ï¼Œç¡®ä¿æ­¥å¹…è‡³å°‘ä¸º32
        gs = max(int(de_parallel(self.model).stride.max() if self.model else 0), 32)
        # æž„å»ºYOLOæ•°æ®é›†
        return build_yolo_dataset(self.args, img_path, batch, self.data, mode=mode, rect=mode == 'val', stride=gs)

    def get_dataloader(self, dataset_path, batch_size=16, rank=0, mode='train'):
        """æž„å»ºå¹¶è¿”å›žæ•°æ®åŠ è½½å™¨ã€‚"""
        assert mode in ['train', 'val']  # ç¡®ä¿æ¨¡å¼æœ‰æ•ˆ
        with torch_distributed_zero_first(rank):  # åœ¨åˆ†å¸ƒå¼è®­ç»ƒä¸­ï¼Œç¡®ä¿æ•°æ®é›†åªåˆå§‹åŒ–ä¸€æ¬¡
            dataset = self.build_dataset(dataset_path, mode, batch_size)
        shuffle = mode == 'train'  # è®­ç»ƒæ¨¡å¼ä¸‹æ‰“ä¹±æ•°æ®
        # å¦‚æžœæ•°æ®é›†ä¸ºçŸ©å½¢ä¸”éœ€è¦æ‰“ä¹±ï¼Œå‘å‡ºè­¦å‘Šå¹¶ç¦ç”¨æ‰“ä¹±
        if getattr(dataset, 'rect', False) and shuffle:
            LOGGER.warning("WARNING âš ï¸ 'rect=True' is incompatible with DataLoader shuffle, setting shuffle=False")
            shuffle = False
        workers = self.args.workers if mode == 'train' else self.args.workers * 2  # è®¾ç½®å·¥ä½œçº¿ç¨‹æ•°
        return build_dataloader(dataset, batch_size, workers, shuffle, rank)  # è¿”å›žæ•°æ®åŠ è½½å™¨

    def preprocess_batch(self, batch):
        """å¯¹å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼Œç¼©æ”¾å¹¶è½¬æ¢ä¸ºæµ®ç‚¹æ•°ã€‚"""
        batch['img'] = batch['img'].to(self.device, non_blocking=True).float() / 255  # å½’ä¸€åŒ–åˆ°[0, 1]
        return batch

    def set_model_attributes(self):
        """è®¾ç½®æ¨¡åž‹çš„å±žæ€§ï¼ŒåŒ…æ‹¬ç±»åˆ«æ•°é‡å’Œåç§°ã€‚"""
        self.model.nc = self.data['nc']  # å°†ç±»åˆ«æ•°é‡é™„åŠ åˆ°æ¨¡åž‹
        self.model.names = self.data['names']  # å°†ç±»åˆ«åç§°é™„åŠ åˆ°æ¨¡åž‹
        self.model.args = self.args  # å°†è¶…å‚æ•°é™„åŠ åˆ°æ¨¡åž‹

    def get_model(self, cfg=None, weights=None, verbose=True):
        """è¿”å›žYOLOæ£€æµ‹æ¨¡åž‹ã€‚"""
        model = DetectionModel(cfg, nc=self.data['nc'], verbose=verbose and RANK == -1)  # åˆ›å»ºæ£€æµ‹æ¨¡åž‹
        if weights:
            model.load(weights)  # åŠ è½½æƒé‡
        return model

    def get_validator(self):
        """è¿”å›žYOLOæ¨¡åž‹éªŒè¯å™¨ã€‚"""
        self.loss_names = 'box_loss', 'cls_loss', 'dfl_loss'  # å®šä¹‰æŸå¤±åç§°
        return yolo.detect.DetectionValidator(self.test_loader, save_dir=self.save_dir, args=copy(self.args))

    def plot_training_samples(self, batch, ni):
        """ç»˜åˆ¶è®­ç»ƒæ ·æœ¬åŠå…¶æ³¨é‡Šã€‚"""
        plot_images(images=batch['img'],
                    batch_idx=batch['batch_idx'],
                    cls=batch['cls'].squeeze(-1),
                    bboxes=batch['bboxes'],
                    paths=batch['im_file'],
                    fname=self.save_dir / f'train_batch{ni}.jpg',
                    on_plot=self.on_plot)

    def plot_metrics(self):
        """ç»˜åˆ¶æ¥è‡ªCSVæ–‡ä»¶çš„æŒ‡æ ‡ã€‚"""
        plot_results(file=self.csv, on_plot=self.on_plot)  # ä¿å­˜ç»“æžœå›¾
```

### ä»£ç è¯´æ˜Žï¼š
1. **ç±»å®šä¹‰**ï¼š`DetectionTrainer`ç±»ç”¨äºŽè®­ç»ƒYOLOæ£€æµ‹æ¨¡åž‹ï¼Œç»§æ‰¿è‡ª`BaseTrainer`ã€‚
2. **æ•°æ®é›†æž„å»º**ï¼š`build_dataset`æ–¹æ³•ç”¨äºŽæž„å»ºYOLOæ•°æ®é›†ï¼Œæ”¯æŒè®­ç»ƒå’ŒéªŒè¯æ¨¡å¼ã€‚
3. **æ•°æ®åŠ è½½å™¨**ï¼š`get_dataloader`æ–¹æ³•åˆ›å»ºæ•°æ®åŠ è½½å™¨ï¼Œæ”¯æŒå¤šçº¿ç¨‹å’Œæ•°æ®æ‰“ä¹±ã€‚
4. **æ‰¹å¤„ç†é¢„å¤„ç†**ï¼š`preprocess_batch`æ–¹æ³•å°†å›¾åƒæ‰¹æ¬¡å½’ä¸€åŒ–åˆ°[0, 1]èŒƒå›´ã€‚
5. **æ¨¡åž‹å±žæ€§è®¾ç½®**ï¼š`set_model_attributes`æ–¹æ³•è®¾ç½®æ¨¡åž‹çš„ç±»åˆ«æ•°é‡å’Œåç§°ã€‚
6. **æ¨¡åž‹èŽ·å–**ï¼š`get_model`æ–¹æ³•è¿”å›žYOLOæ£€æµ‹æ¨¡åž‹ï¼Œå¹¶å¯åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚
7. **éªŒè¯å™¨èŽ·å–**ï¼š`get_validator`æ–¹æ³•è¿”å›žç”¨äºŽæ¨¡åž‹éªŒè¯çš„å¯¹è±¡ã€‚
8. **ç»˜å›¾æ–¹æ³•**ï¼š`plot_training_samples`å’Œ`plot_metrics`æ–¹æ³•ç”¨äºŽå¯è§†åŒ–è®­ç»ƒæ ·æœ¬å’Œè®­ç»ƒæŒ‡æ ‡ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯ä¸€ä¸ªç”¨äºŽè®­ç»ƒYOLOï¼ˆYou Only Look Onceï¼‰ç›®æ ‡æ£€æµ‹æ¨¡åž‹çš„Pythonè„šæœ¬ï¼Œå±žäºŽUltralytics YOLOé¡¹ç›®çš„ä¸€éƒ¨åˆ†ã€‚è¯¥æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º`DetectionTrainer`çš„ç±»ï¼Œç»§æ‰¿è‡ª`BaseTrainer`ï¼Œç”¨äºŽå¤„ç†ç›®æ ‡æ£€æµ‹ä»»åŠ¡çš„è®­ç»ƒè¿‡ç¨‹ã€‚

åœ¨æ–‡ä»¶å¼€å¤´ï¼Œå¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“å’Œæ¨¡å—ï¼ŒåŒ…æ‹¬ç”¨äºŽæ•°æ®å¤„ç†çš„`build_dataloader`å’Œ`build_yolo_dataset`ï¼Œç”¨äºŽè®­ç»ƒçš„`BaseTrainer`ï¼Œä»¥åŠYOLOæ¨¡åž‹å’Œç›¸å…³å·¥å…·ã€‚æŽ¥ä¸‹æ¥ï¼Œ`DetectionTrainer`ç±»çš„å®šä¹‰å¼€å§‹ã€‚

è¯¥ç±»åŒ…å«å¤šä¸ªæ–¹æ³•ï¼Œç”¨äºŽæž„å»ºæ•°æ®é›†ã€èŽ·å–æ•°æ®åŠ è½½å™¨ã€é¢„å¤„ç†å›¾åƒæ‰¹æ¬¡ã€è®¾ç½®æ¨¡åž‹å±žæ€§ã€èŽ·å–æ¨¡åž‹ã€èŽ·å–éªŒè¯å™¨ã€è®°å½•æŸå¤±é¡¹ã€ç”Ÿæˆè®­ç»ƒè¿›åº¦å­—ç¬¦ä¸²ã€ç»˜åˆ¶è®­ç»ƒæ ·æœ¬å’Œç»˜åˆ¶è®­ç»ƒæŒ‡æ ‡ç­‰ã€‚

`build_dataset`æ–¹æ³•ç”¨äºŽæž„å»ºYOLOæ•°æ®é›†ï¼ŒæŽ¥å—å›¾åƒè·¯å¾„ã€æ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰å’Œæ‰¹æ¬¡å¤§å°ä½œä¸ºå‚æ•°ã€‚å®ƒä½¿ç”¨`build_yolo_dataset`å‡½æ•°æ¥åˆ›å»ºæ•°æ®é›†ï¼Œå¹¶æ ¹æ®æ¨¡åž‹çš„æ­¥å¹…å¤§å°è¿›è¡Œè°ƒæ•´ã€‚

`get_dataloader`æ–¹æ³•ç”¨äºŽæž„å»ºå’Œè¿”å›žæ•°æ®åŠ è½½å™¨ã€‚å®ƒæ ¹æ®æ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰æ¥å†³å®šæ˜¯å¦æ‰“ä¹±æ•°æ®ï¼Œå¹¶æ ¹æ®éœ€è¦è°ƒæ•´å·¥ä½œçº¿ç¨‹çš„æ•°é‡ã€‚

`preprocess_batch`æ–¹æ³•è´Ÿè´£å¯¹å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼Œå°†å›¾åƒè½¬æ¢ä¸ºæµ®ç‚¹æ•°å¹¶ç¼©æ”¾åˆ°[0, 1]èŒƒå›´ã€‚

`set_model_attributes`æ–¹æ³•ç”¨äºŽè®¾ç½®æ¨¡åž‹çš„å±žæ€§ï¼ŒåŒ…æ‹¬ç±»åˆ«æ•°é‡å’Œç±»åˆ«åç§°ã€‚

`get_model`æ–¹æ³•è¿”å›žä¸€ä¸ªYOLOæ£€æµ‹æ¨¡åž‹å®žä¾‹ï¼Œå¹¶å¯ä»¥åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚

`get_validator`æ–¹æ³•è¿”å›žä¸€ä¸ªç”¨äºŽæ¨¡åž‹éªŒè¯çš„`DetectionValidator`å®žä¾‹ã€‚

`label_loss_items`æ–¹æ³•è¿”å›žä¸€ä¸ªåŒ…å«è®­ç»ƒæŸå¤±é¡¹çš„å­—å…¸ï¼Œæ–¹ä¾¿åŽç»­çš„æŸå¤±è®°å½•å’Œåˆ†æžã€‚

`progress_string`æ–¹æ³•ç”Ÿæˆä¸€ä¸ªæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ï¼Œæ˜¾ç¤ºè®­ç»ƒè¿›åº¦ï¼ŒåŒ…æ‹¬å½“å‰çš„è½®æ¬¡ã€GPUå†…å­˜ä½¿ç”¨æƒ…å†µã€æŸå¤±å€¼ã€å®žä¾‹æ•°é‡å’Œå›¾åƒå¤§å°ã€‚

`plot_training_samples`æ–¹æ³•ç”¨äºŽç»˜åˆ¶è®­ç»ƒæ ·æœ¬åŠå…¶æ ‡æ³¨ï¼Œä¾¿äºŽå¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹ã€‚

æœ€åŽï¼Œ`plot_metrics`å’Œ`plot_training_labels`æ–¹æ³•åˆ†åˆ«ç”¨äºŽç»˜åˆ¶è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŒ‡æ ‡å’Œæ ‡æ³¨å›¾ï¼Œå¸®åŠ©ç”¨æˆ·åˆ†æžæ¨¡åž‹çš„è®­ç»ƒæ•ˆæžœã€‚

æ•´ä½“è€Œè¨€ï¼Œè¿™ä¸ªæ–‡ä»¶æä¾›äº†ä¸€ä¸ªç»“æž„åŒ–çš„æ¡†æž¶ï¼Œç”¨äºŽè®­ç»ƒYOLOç›®æ ‡æ£€æµ‹æ¨¡åž‹ï¼Œæ¶µç›–äº†æ•°æ®å¤„ç†ã€æ¨¡åž‹è®­ç»ƒã€æŸå¤±è®°å½•å’Œç»“æžœå¯è§†åŒ–ç­‰å¤šä¸ªæ–¹é¢ã€‚

#### 11.6 train.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼Œä¸»è¦é›†ä¸­åœ¨YOLOæ£€æµ‹æ¨¡åž‹çš„è®­ç»ƒè¿‡ç¨‹ä¸­ã€‚

```python
import random
import numpy as np
import torch.nn as nn
from ultralytics.data import build_dataloader, build_yolo_dataset
from ultralytics.engine.trainer import BaseTrainer
from ultralytics.models import yolo
from ultralytics.nn.tasks import DetectionModel
from ultralytics.utils import LOGGER, RANK
from ultralytics.utils.torch_utils import de_parallel, torch_distributed_zero_first

class DetectionTrainer(BaseTrainer):
    """
    åŸºäºŽæ£€æµ‹æ¨¡åž‹çš„è®­ç»ƒç±»ï¼Œç»§æ‰¿è‡ªBaseTrainerç±»ã€‚
    """

    def build_dataset(self, img_path, mode="train", batch=None):
        """
        æž„å»ºYOLOæ•°æ®é›†ã€‚

        å‚æ•°:
            img_path (str): å›¾åƒæ–‡ä»¶å¤¹çš„è·¯å¾„ã€‚
            mode (str): æ¨¡å¼ï¼Œ`train`æˆ–`val`ï¼Œç”¨æˆ·å¯ä»¥ä¸ºæ¯ç§æ¨¡å¼è‡ªå®šä¹‰ä¸åŒçš„å¢žå¼ºã€‚
            batch (int, optional): æ‰¹æ¬¡å¤§å°ï¼Œä»…ç”¨äºŽ`rect`æ¨¡å¼ã€‚é»˜è®¤ä¸ºNoneã€‚
        """
        gs = max(int(de_parallel(self.model).stride.max() if self.model else 0), 32)  # èŽ·å–æ¨¡åž‹çš„æœ€å¤§æ­¥å¹…
        return build_yolo_dataset(self.args, img_path, batch, self.data, mode=mode, rect=mode == "val", stride=gs)

    def get_dataloader(self, dataset_path, batch_size=16, rank=0, mode="train"):
        """æž„é€ å¹¶è¿”å›žæ•°æ®åŠ è½½å™¨ã€‚"""
        assert mode in ["train", "val"]  # ç¡®ä¿æ¨¡å¼æœ‰æ•ˆ
        with torch_distributed_zero_first(rank):  # ä»…åœ¨DDPä¸­åˆå§‹åŒ–æ•°æ®é›†*.cacheä¸€æ¬¡
            dataset = self.build_dataset(dataset_path, mode, batch_size)  # æž„å»ºæ•°æ®é›†
        shuffle = mode == "train"  # è®­ç»ƒæ¨¡å¼ä¸‹æ‰“ä¹±æ•°æ®
        workers = self.args.workers if mode == "train" else self.args.workers * 2  # è®¾ç½®å·¥ä½œçº¿ç¨‹æ•°
        return build_dataloader(dataset, batch_size, workers, shuffle, rank)  # è¿”å›žæ•°æ®åŠ è½½å™¨

    def preprocess_batch(self, batch):
        """å¯¹å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬ç¼©æ”¾å’Œè½¬æ¢ä¸ºæµ®ç‚¹æ•°ã€‚"""
        batch["img"] = batch["img"].to(self.device, non_blocking=True).float() / 255  # è½¬æ¢ä¸ºæµ®ç‚¹æ•°å¹¶å½’ä¸€åŒ–
        if self.args.multi_scale:  # å¦‚æžœå¯ç”¨å¤šå°ºåº¦
            imgs = batch["img"]
            sz = (
                random.randrange(self.args.imgsz * 0.5, self.args.imgsz * 1.5 + self.stride)
                // self.stride
                * self.stride
            )  # éšæœºé€‰æ‹©å°ºå¯¸
            sf = sz / max(imgs.shape[2:])  # è®¡ç®—ç¼©æ”¾å› å­
            if sf != 1:
                ns = [
                    math.ceil(x * sf / self.stride) * self.stride for x in imgs.shape[2:]
                ]  # è®¡ç®—æ–°çš„å½¢çŠ¶
                imgs = nn.functional.interpolate(imgs, size=ns, mode="bilinear", align_corners=False)  # è¿›è¡Œæ’å€¼
            batch["img"] = imgs  # æ›´æ–°æ‰¹æ¬¡å›¾åƒ
        return batch

    def get_model(self, cfg=None, weights=None, verbose=True):
        """è¿”å›žYOLOæ£€æµ‹æ¨¡åž‹ã€‚"""
        model = DetectionModel(cfg, nc=self.data["nc"], verbose=verbose and RANK == -1)  # åˆ›å»ºæ£€æµ‹æ¨¡åž‹
        if weights:
            model.load(weights)  # åŠ è½½æƒé‡
        return model

    def plot_training_samples(self, batch, ni):
        """ç»˜åˆ¶å¸¦æœ‰æ³¨é‡Šçš„è®­ç»ƒæ ·æœ¬ã€‚"""
        plot_images(
            images=batch["img"],
            batch_idx=batch["batch_idx"],
            cls=batch["cls"].squeeze(-1),
            bboxes=batch["bboxes"],
            paths=batch["im_file"],
            fname=self.save_dir / f"train_batch{ni}.jpg",
            on_plot=self.on_plot,
        )

    def plot_metrics(self):
        """ä»ŽCSVæ–‡ä»¶ä¸­ç»˜åˆ¶æŒ‡æ ‡ã€‚"""
        plot_results(file=self.csv, on_plot=self.on_plot)  # ä¿å­˜ç»“æžœå›¾
```

### ä»£ç æ³¨é‡Šè¯´æ˜Žï¼š
1. **æž„å»ºæ•°æ®é›†**ï¼š`build_dataset`æ–¹æ³•ç”¨äºŽæ ¹æ®ç»™å®šçš„å›¾åƒè·¯å¾„å’Œæ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰æž„å»ºYOLOæ•°æ®é›†ï¼Œå¹¶å¤„ç†ç›¸å…³å‚æ•°ã€‚
2. **æ•°æ®åŠ è½½å™¨**ï¼š`get_dataloader`æ–¹æ³•æž„é€ æ•°æ®åŠ è½½å™¨ï¼Œæ”¯æŒå¤šè¿›ç¨‹åŠ è½½å’Œæ•°æ®æ‰“ä¹±ã€‚
3. **æ‰¹æ¬¡é¢„å¤„ç†**ï¼š`preprocess_batch`æ–¹æ³•å¯¹è¾“å…¥çš„å›¾åƒæ‰¹æ¬¡è¿›è¡Œå½’ä¸€åŒ–å’Œç¼©æ”¾å¤„ç†ï¼Œä»¥é€‚åº”æ¨¡åž‹è¾“å…¥è¦æ±‚ã€‚
4. **æ¨¡åž‹èŽ·å–**ï¼š`get_model`æ–¹æ³•è¿”å›žä¸€ä¸ªYOLOæ£€æµ‹æ¨¡åž‹å®žä¾‹ï¼Œå¹¶å¯é€‰æ‹©æ€§åœ°åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚
5. **ç»˜åˆ¶è®­ç»ƒæ ·æœ¬**ï¼š`plot_training_samples`æ–¹æ³•ç”¨äºŽå¯è§†åŒ–è®­ç»ƒæ ·æœ¬åŠå…¶å¯¹åº”çš„æ ‡ç­¾ï¼Œä¾¿äºŽè°ƒè¯•å’ŒéªŒè¯æ¨¡åž‹æ•ˆæžœã€‚
6. **ç»˜åˆ¶æŒ‡æ ‡**ï¼š`plot_metrics`æ–¹æ³•ç”¨äºŽä»ŽCSVæ–‡ä»¶ä¸­æå–è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŒ‡æ ‡å¹¶è¿›è¡Œå¯è§†åŒ–ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `train.py` æ˜¯ä¸€ä¸ªç”¨äºŽè®­ç»ƒ YOLOï¼ˆYou Only Look Onceï¼‰ç›®æ ‡æ£€æµ‹æ¨¡åž‹çš„å®žçŽ°ï¼ŒåŸºäºŽ Ultralytics æä¾›çš„æ¡†æž¶ã€‚ç¨‹åºä¸­å®šä¹‰äº†ä¸€ä¸ªåä¸º `DetectionTrainer` çš„ç±»ï¼Œç»§æ‰¿è‡ª `BaseTrainer`ï¼Œç”¨äºŽå¤„ç†ç›®æ ‡æ£€æµ‹ä»»åŠ¡çš„è®­ç»ƒè¿‡ç¨‹ã€‚

åœ¨è¿™ä¸ªç±»ä¸­ï¼Œé¦–å…ˆå®šä¹‰äº†ä¸€ä¸ª `build_dataset` æ–¹æ³•ï¼Œç”¨äºŽæž„å»º YOLO æ•°æ®é›†ã€‚è¯¥æ–¹æ³•æŽ¥æ”¶å›¾åƒè·¯å¾„ã€æ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰å’Œæ‰¹æ¬¡å¤§å°ä½œä¸ºå‚æ•°ã€‚å®ƒä¼šæ ¹æ®æ¨¡åž‹çš„æ­¥å¹…è®¡ç®—å‡ºåˆé€‚çš„å›¾åƒå°ºå¯¸ï¼Œå¹¶è°ƒç”¨ `build_yolo_dataset` å‡½æ•°æ¥ç”Ÿæˆæ•°æ®é›†ã€‚

æŽ¥ä¸‹æ¥æ˜¯ `get_dataloader` æ–¹æ³•ï¼Œå®ƒè´Ÿè´£æž„å»ºå¹¶è¿”å›žæ•°æ®åŠ è½½å™¨ã€‚æ ¹æ®ä¼ å…¥çš„æ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰ï¼Œå®ƒä¼šåˆå§‹åŒ–æ•°æ®é›†ï¼Œå¹¶æ ¹æ®æ˜¯å¦éœ€è¦æ‰“ä¹±æ•°æ®æ¥è®¾ç½® `shuffle` å‚æ•°ã€‚è¿™ä¸ªæ–¹æ³•è¿˜ä¼šæ ¹æ®è®­ç»ƒæ¨¡å¼çš„ä¸åŒè°ƒæ•´å·¥ä½œçº¿ç¨‹çš„æ•°é‡ã€‚

`preprocess_batch` æ–¹æ³•ç”¨äºŽå¯¹ä¸€æ‰¹å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å°†å›¾åƒç¼©æ”¾åˆ°é€‚å½“çš„å¤§å°å¹¶è½¬æ¢ä¸ºæµ®ç‚¹æ•°æ ¼å¼ã€‚è¿™é‡Œè¿˜å®žçŽ°äº†å¤šå°ºåº¦è®­ç»ƒçš„åŠŸèƒ½ï¼Œé€šè¿‡éšæœºé€‰æ‹©å›¾åƒå¤§å°æ¥å¢žå¼ºæ¨¡åž‹çš„é²æ£’æ€§ã€‚

`set_model_attributes` æ–¹æ³•ç”¨äºŽè®¾ç½®æ¨¡åž‹çš„å±žæ€§ï¼ŒåŒ…æ‹¬ç±»åˆ«æ•°é‡å’Œç±»åˆ«åç§°ç­‰ã€‚è¿™äº›ä¿¡æ¯æ˜¯ä»Žæ•°æ®é›†ä¸­æå–çš„ï¼Œå¹¶å°†å…¶é™„åŠ åˆ°æ¨¡åž‹ä¸Šã€‚

`get_model` æ–¹æ³•è¿”å›žä¸€ä¸ª YOLO æ£€æµ‹æ¨¡åž‹å®žä¾‹ï¼Œæ”¯æŒåŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚

`get_validator` æ–¹æ³•è¿”å›žä¸€ä¸ªç”¨äºŽæ¨¡åž‹éªŒè¯çš„ `DetectionValidator` å®žä¾‹ï¼Œè®¾ç½®äº†æŸå¤±åç§°ä»¥ä¾¿åŽç»­ç›‘æŽ§è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŸå¤±æƒ…å†µã€‚

`label_loss_items` æ–¹æ³•ç”¨äºŽè¿”å›žå¸¦æœ‰æ ‡ç­¾çš„è®­ç»ƒæŸå¤±é¡¹å­—å…¸ï¼Œä¾¿äºŽåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è¿›è¡Œç›‘æŽ§å’Œè®°å½•ã€‚

`progress_string` æ–¹æ³•è¿”å›žä¸€ä¸ªæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ï¼Œæ˜¾ç¤ºè®­ç»ƒè¿›åº¦ï¼ŒåŒ…æ‹¬å½“å‰çš„ epochã€GPU å†…å­˜ä½¿ç”¨æƒ…å†µã€æŸå¤±å€¼ã€å®žä¾‹æ•°é‡å’Œå›¾åƒå¤§å°ç­‰ä¿¡æ¯ã€‚

`plot_training_samples` æ–¹æ³•ç”¨äºŽç»˜åˆ¶è®­ç»ƒæ ·æœ¬åŠå…¶æ ‡æ³¨ï¼Œç”Ÿæˆçš„å›¾åƒå°†ä¿å­˜åˆ°æŒ‡å®šçš„ç›®å½•ä¸­ã€‚

æœ€åŽï¼Œ`plot_metrics` å’Œ `plot_training_labels` æ–¹æ³•åˆ†åˆ«ç”¨äºŽç»˜åˆ¶è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŒ‡æ ‡å’Œåˆ›å»ºå¸¦æœ‰æ ‡ç­¾çš„è®­ç»ƒå›¾åƒï¼Œå¸®åŠ©ç”¨æˆ·æ›´å¥½åœ°ç†è§£æ¨¡åž‹çš„è®­ç»ƒæ•ˆæžœã€‚

æ•´ä½“æ¥çœ‹ï¼Œè¿™ä¸ªç¨‹åºæ–‡ä»¶æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„è®­ç»ƒæµç¨‹ï¼Œæ¶µç›–äº†æ•°æ®é›†æž„å»ºã€æ•°æ®åŠ è½½ã€æ¨¡åž‹è®¾ç½®ã€è®­ç»ƒç›‘æŽ§å’Œç»“æžœå¯è§†åŒ–ç­‰å¤šä¸ªæ–¹é¢ï¼Œæ—¨åœ¨å¸®åŠ©ç”¨æˆ·é«˜æ•ˆåœ°è®­ç»ƒ YOLO ç›®æ ‡æ£€æµ‹æ¨¡åž‹ã€‚

### 12.ç³»ç»Ÿæ•´ä½“ç»“æž„ï¼ˆèŠ‚é€‰ï¼‰

### æ•´ä½“åŠŸèƒ½å’Œæž„æž¶æ¦‚æ‹¬

è¯¥é¡¹ç›®ä¸»è¦æ˜¯ä¸€ä¸ªåŸºäºŽYOLOï¼ˆYou Only Look Onceï¼‰ç®—æ³•çš„ç›®æ ‡æ£€æµ‹æ¡†æž¶ï¼Œç»“åˆäº†å¤šç§æ·±åº¦å­¦ä¹ æŠ€æœ¯å’Œæ¨¡åž‹ï¼ˆå¦‚Swin Transformerï¼‰ï¼Œæ—¨åœ¨æä¾›é«˜æ•ˆçš„ç›®æ ‡æ£€æµ‹å’Œè·Ÿè¸ªè§£å†³æ–¹æ¡ˆã€‚é¡¹ç›®çš„ç»“æž„æ¸…æ™°ï¼Œæ¨¡å—åŒ–è®¾è®¡ä½¿å¾—å„ä¸ªåŠŸèƒ½ç»„ä»¶ç›¸å¯¹ç‹¬ç«‹ï¼Œä¾¿äºŽç»´æŠ¤å’Œæ‰©å±•ã€‚

- **ç›®æ ‡æ£€æµ‹**ï¼šé€šè¿‡YOLOæ¨¡åž‹è¿›è¡Œå®žæ—¶ç›®æ ‡æ£€æµ‹ï¼Œæ”¯æŒå¤šç§è¾“å…¥æºï¼ˆå¦‚å›¾åƒã€è§†é¢‘æµï¼‰ã€‚
- **æ¨¡åž‹è®­ç»ƒ**ï¼šæä¾›äº†è®­ç»ƒYOLOæ¨¡åž‹çš„å®Œæ•´æµç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®é›†æž„å»ºã€æ•°æ®åŠ è½½ã€æ¨¡åž‹è®­ç»ƒå’Œç»“æžœå¯è§†åŒ–ã€‚
- **ç›®æ ‡è·Ÿè¸ª**ï¼šå®žçŽ°äº†ç›®æ ‡è·Ÿè¸ªåŠŸèƒ½ï¼Œèƒ½å¤Ÿåœ¨è§†é¢‘æµä¸­æŒç»­è·Ÿè¸ªæ£€æµ‹åˆ°çš„å¯¹è±¡ã€‚
- **å¯è§†åŒ–ä¸Žåˆ†æž**ï¼šæä¾›äº†å¯è§†åŒ–å·¥å…·ï¼Œå¸®åŠ©ç”¨æˆ·åˆ†æžè®­ç»ƒè¿‡ç¨‹å’Œæ¨¡åž‹æ€§èƒ½ã€‚

### æ–‡ä»¶åŠŸèƒ½æ•´ç†è¡¨

| æ–‡ä»¶è·¯å¾„                                                                                       | åŠŸèƒ½æè¿°                                                                                     |
|----------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------|
| `code\ultralytics\solutions\ai_gym.py`                                                      | å®žçŽ°äº†ä¸€ä¸ªç”¨äºŽå®žæ—¶è§†é¢‘æµä¸­åŸºäºŽäººä½“å§¿æ€ç®¡ç†å¥èº«åŠ¨ä½œè®¡æ•°çš„ç±»ï¼Œç»“åˆå§¿æ€ä¼°è®¡å’Œå¯è§†åŒ–æŠ€æœ¯ã€‚                       |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéžå¿…è¦ï¼‰\ultralytics\nn\backbone\SwinTransformer.py` | å®žçŽ°äº†Swin Transformeræ¨¡åž‹çš„æ ¸å¿ƒç»„ä»¶ï¼Œæä¾›ç‰¹å¾æå–åŠŸèƒ½ï¼Œé€‚ç”¨äºŽè®¡ç®—æœºè§†è§‰ä»»åŠ¡ã€‚                          |
| `code\ultralytics\trackers\utils\__init__.py`                                              | å°†`trackers`æ¨¡å—æ ‡è®°ä¸ºä¸€ä¸ªPythonåŒ…ï¼Œä¾¿äºŽå¯¼å…¥å’Œä½¿ç”¨ï¼Œä¸»è¦ç”¨äºŽç›®æ ‡è·Ÿè¸ªåŠŸèƒ½ã€‚                           |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéžå¿…è¦ï¼‰\ultralytics\engine\predictor.py`   | æä¾›YOLOæ¨¡åž‹çš„æŽ¨ç†æ¡†æž¶ï¼Œå¤„ç†å›¾åƒã€è§†é¢‘æµç­‰è¾“å…¥æºï¼Œè¿›è¡Œç›®æ ‡æ£€æµ‹å’Œç»“æžœå¯è§†åŒ–ã€‚                           |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéžå¿…è¦ï¼‰\ultralytics\models\yolo\detect\train.py` | å®žçŽ°YOLOç›®æ ‡æ£€æµ‹æ¨¡åž‹çš„è®­ç»ƒæµç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®é›†æž„å»ºã€æ•°æ®åŠ è½½ã€æ¨¡åž‹è®­ç»ƒå’ŒæŸå¤±ç›‘æŽ§ç­‰åŠŸèƒ½ã€‚                 |
| `train.py`                                                                                   | è®­ç»ƒYOLOç›®æ ‡æ£€æµ‹æ¨¡åž‹çš„ä¸»ç¨‹åºï¼ŒåŒ…å«æ•°æ®é›†æž„å»ºã€æ¨¡åž‹è®¾ç½®å’Œè®­ç»ƒç›‘æŽ§ç­‰åŠŸèƒ½ã€‚                              |
| `code\ultralytics\data\split_dota.py`                                                      | ç”¨äºŽå°†DOTAæ•°æ®é›†åˆ†å‰²ä¸ºè®­ç»ƒé›†å’ŒéªŒè¯é›†ï¼Œæ”¯æŒYOLOæ ¼å¼çš„æ•°æ®é›†æž„å»ºã€‚                                     |
| `code\ultralytics\engine\validator.py`                                                     | å®žçŽ°æ¨¡åž‹éªŒè¯åŠŸèƒ½ï¼Œè¯„ä¼°è®­ç»ƒè¿‡ç¨‹ä¸­æ¨¡åž‹çš„æ€§èƒ½ï¼Œè®¡ç®—å„ç§æŒ‡æ ‡ä»¥ç›‘æŽ§è®­ç»ƒæ•ˆæžœã€‚                               |
| `code\ultralytics\utils\ops.py`                                                             | æä¾›ä¸€äº›é€šç”¨çš„æ“ä½œå’Œå·¥å…·å‡½æ•°ï¼Œå¯èƒ½åŒ…æ‹¬å›¾åƒå¤„ç†ã€å¼ é‡æ“ä½œç­‰ã€‚                                         |
| `code\ultralytics\models\rtdetr\model.py`                                                  | å®žçŽ°RT-DETRæ¨¡åž‹çš„ç»“æž„å’ŒåŠŸèƒ½ï¼Œé€‚ç”¨äºŽç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚                                               |
| `code\ultralytics\utils\torch_utils.py`                                                    | æä¾›ä¸ŽPyTorchç›¸å…³çš„å·¥å…·å‡½æ•°ï¼Œå¯èƒ½åŒ…æ‹¬æ¨¡åž‹åŠ è½½ã€è®¾å¤‡ç®¡ç†ç­‰åŠŸèƒ½ã€‚                                    |
| `code\ultralytics\trackers\utils\gmc.py`                                                  | å®žçŽ°ç›®æ ‡è·Ÿè¸ªä¸­çš„ä¸€äº›é€šç”¨æ–¹æ³•å’Œè®¡ç®—ï¼Œå¯èƒ½æ¶‰åŠåˆ°å›¾åƒå¤„ç†å’Œç‰¹å¾åŒ¹é…ç­‰ã€‚                                  |
| `code\ultralytics\models\yolo\detect\__init__.py`                                         | åˆå§‹åŒ–YOLOæ£€æµ‹æ¨¡å—ï¼Œå¯èƒ½å¯¼å…¥ç›¸å…³çš„ç±»å’Œå‡½æ•°ï¼Œä¾¿äºŽç”¨æˆ·ä½¿ç”¨ã€‚                                        |

è¿™ä¸ªè¡¨æ ¼æ€»ç»“äº†é¡¹ç›®ä¸­å„ä¸ªæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½ï¼Œå±•ç¤ºäº†é¡¹ç›®çš„æ¨¡å—åŒ–è®¾è®¡å’Œå„ä¸ªç»„ä»¶ä¹‹é—´çš„å…³ç³»ã€‚

æ³¨æ„ï¼šç”±äºŽæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰â€ä¸­éƒ¨åˆ†ä»£ç å¯èƒ½ä¼šä¼˜åŒ–å‡çº§ï¼Œä»…ä¾›å‚è€ƒå­¦ä¹ ï¼Œå®Œæ•´â€œè®­ç»ƒæºç â€ã€â€œWebå‰ç«¯ç•Œé¢â€å’Œâ€œ70+ç§åˆ›æ–°ç‚¹æºç â€ä»¥â€œ13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†èŽ·å–â€çš„å†…å®¹ä¸ºå‡†ã€‚

### 13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†èŽ·å–

![19.png](19.png)


# [ä¸‹è½½é“¾æŽ¥ï¼šhttps://mbd.pub/o/bread/ZpuZlpdq](https://mbd.pub/o/bread/ZpuZlpdq)